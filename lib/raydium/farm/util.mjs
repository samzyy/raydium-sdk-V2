var gn=Object.defineProperty,hn=Object.defineProperties;var wn=Object.getOwnPropertyDescriptors;var gt=Object.getOwnPropertySymbols;var yn=Object.prototype.hasOwnProperty,bn=Object.prototype.propertyIsEnumerable;var ht=(e,t,n)=>t in e?gn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,O=(e,t)=>{for(var n in t||(t={}))yn.call(t,n)&&ht(e,n,t[n]);if(gt)for(var n of gt(t))bn.call(t,n)&&ht(e,n,t[n]);return e},G=(e,t)=>hn(e,wn(t));import j from"bn.js";import{PublicKey as Pn}from"@solana/web3.js";import{get as wt,set as Tn}from"lodash";var je=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},yt={},xn={};function K(e){let t=wt(yt,e);if(!t){let n=wt(xn,e);t=new je({name:e,logLevel:n}),Tn(yt,e,t)}return t}import{MINT_SIZE as Si,TOKEN_PROGRAM_ID as Li,getTransferFeeConfig as Ai,unpackMint as Bi}from"@solana/spl-token";var Ze=K("Raydium_accountInfo_util");async function bt(e,t,n){let{batchRequest:r,commitment:i="confirmed",chunkCount:o=100}=O({batchRequest:!1},n),s=ze(t,o),a=new Array(s.length).fill([]);if(r){let c=s.map(d=>{let f=e._buildArgs([d.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:f}}),u=ze(c,10);a=(await(await Promise.all(u.map(async d=>await e._rpcBatchRequest(d)))).flat()).map(d=>(d.error&&Ze.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${d.error.message}`),d.result.value.map(f=>{if(f){let{data:p,executable:x,lamports:y,owner:B,rentEpoch:S}=f;return p.length!==2&&p[1]!=="base64"&&Ze.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:x,lamports:y,owner:new Pn(B),rentEpoch:S}}return null})))}else try{a=await Promise.all(s.map(c=>e.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&Ze.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}async function Tt(e,t,n){let r=await bt(e,t.map(i=>i.pubkey),n);return t.map((i,o)=>G(O({},i),{accountInfo:r[o]}))}import te from"bn.js";var le=9e15,se=1e9,Xe="0123456789abcdef",ke="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",Ie="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",Je={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-le,maxE:le,crypto:!1},Lt,Y,b=!0,Re="[DecimalError] ",oe=Re+"Invalid argument: ",At=Re+"Precision limit exceeded",Bt=Re+"crypto unavailable",kt="[object Decimal]",q=Math.floor,V=Math.pow,Sn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Ln=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,An=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,It=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Q=1e7,w=7,Bn=9007199254740991,kn=ke.length-1,Ye=Ie.length-1,m={toStringTag:kt};m.absoluteValue=m.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),h(e)};m.ceil=function(){return h(new this.constructor(this),this.e+1,2)};m.clampedTo=m.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(oe+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};m.comparedTo=m.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};m.cosine=m.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=In(r,_t(r,n)),r.precision=e,r.rounding=t,h(Y==2||Y==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};m.cubeRoot=m.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,l=this,d=l.constructor;if(!l.isFinite()||l.isZero())return new d(l);for(b=!1,o=l.s*V(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=U(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=V(n,1/3),e=q((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new d(n),r.s=l.s):r=new d(o.toString()),s=(e=d.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=C(u.plus(l).times(a),u.plus(c),s+2,1),U(a.d).slice(0,s)===(n=U(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(h(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(h(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return b=!0,h(r,e,d.rounding,t)};m.decimalPlaces=m.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-q(this.e/w))*w,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};m.dividedBy=m.div=function(e){return C(this,new this.constructor(e))};m.dividedToIntegerBy=m.divToInt=function(e){var t=this,n=t.constructor;return h(C(t,new n(e),0,1,1),n.precision,n.rounding)};m.equals=m.eq=function(e){return this.cmp(e)===0};m.floor=function(){return h(new this.constructor(this),this.e+1,3)};m.greaterThan=m.gt=function(e){return this.cmp(e)>0};m.greaterThanOrEqualTo=m.gte=function(e){var t=this.cmp(e);return t==1||t===0};m.hyperbolicCosine=m.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/Me(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=de(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return h(o,s.precision=n,s.rounding=r,!0)};m.hyperbolicSine=m.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=de(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/Me(5,e)),i=de(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,h(i,t,n,!0)};m.hyperbolicTangent=m.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,C(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};m.inverseCosine=m.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?z(n,i,o):new n(0):new n(NaN):t.isZero()?z(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=z(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};m.inverseHyperbolicCosine=m.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,b=!1,n=n.times(n).minus(1).sqrt().plus(n),b=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};m.inverseHyperbolicSine=m.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,b=!1,n=n.times(n).plus(1).sqrt().plus(n),b=!0,r.precision=e,r.rounding=t,n.ln())};m.inverseHyperbolicTangent=m.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?h(new o(i),e,t,!0):(o.precision=n=r-i.e,i=C(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};m.inverseSine=m.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=z(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};m.inverseTangent=m.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&d+4<=Ye)return s=z(l,d+4,f).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(d+4<=Ye)return s=z(l,d+4,f).times(.5),s.s=u.s,s}for(l.precision=a=d+10,l.rounding=1,n=Math.min(28,a/w+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(b=!1,t=Math.ceil(a/w),r=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),b=!0,h(s,l.precision=d,l.rounding=f,!0)};m.isFinite=function(){return!!this.d};m.isInteger=m.isInt=function(){return!!this.d&&q(this.e/w)>this.d.length-2};m.isNaN=function(){return!this.s};m.isNegative=m.isNeg=function(){return this.s<0};m.isPositive=m.isPos=function(){return this.s>0};m.isZero=function(){return!!this.d&&this.d[0]===0};m.lessThan=m.lt=function(e){return this.cmp(e)<0};m.lessThanOrEqualTo=m.lte=function(e){return this.cmp(e)<1};m.logarithm=m.log=function(e){var t,n,r,i,o,s,a,c,u=this,l=u.constructor,d=l.precision,f=l.rounding,p=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(b=!1,a=d+p,s=ie(u,a),r=t?Ce(l,a+10):ie(e,a),c=C(s,r,a,1),ge(c.d,i=d,f))do if(a+=10,s=ie(u,a),r=t?Ce(l,a+10):ie(e,a),c=C(s,r,a,1),!o){+U(c.d).slice(i+1,i+15)+1==1e14&&(c=h(c,d+1,0));break}while(ge(c.d,i+=10,f));return b=!0,h(c,d,f)};m.minus=m.sub=function(e){var t,n,r,i,o,s,a,c,u,l,d,f,p=this,x=p.constructor;if(e=new x(e),!p.d||!e.d)return!p.s||!e.s?e=new x(NaN):p.d?e.s=-e.s:e=new x(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,f=e.d,a=x.precision,c=x.rounding,!u[0]||!f[0]){if(f[0])e.s=-e.s;else if(u[0])e=new x(p);else return new x(c===3?-0:0);return b?h(e,a,c):e}if(n=q(e.e/w),l=q(p.e/w),u=u.slice(),o=l-n,o){for(d=o<0,d?(t=u,o=-o,s=f.length):(t=f,n=l,s=u.length),r=Math.max(Math.ceil(a/w),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=f.length,d=r<s,d&&(s=r),r=0;r<s;r++)if(u[r]!=f[r]){d=u[r]<f[r];break}o=0}for(d&&(t=u,u=f,f=t,e.s=-e.s),s=u.length,r=f.length-s;r>0;--r)u[s++]=0;for(r=f.length;r>o;){if(u[--r]<f[r]){for(i=r;i&&u[--i]===0;)u[i]=Q-1;--u[i],u[r]+=Q}u[r]-=f[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=Ne(u,n),b?h(e,a,c):e):new x(c===3?-0:0)};m.modulo=m.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?h(new r(n),r.precision,r.rounding):(b=!1,r.modulo==9?(t=C(n,e.abs(),0,3,1),t.s*=e.s):t=C(n,e,0,r.modulo,1),t=t.times(e),b=!0,n.minus(t))};m.naturalExponential=m.exp=function(){return $e(this)};m.naturalLogarithm=m.ln=function(){return ie(this)};m.negated=m.neg=function(){var e=new this.constructor(this);return e.s=-e.s,h(e)};m.plus=m.add=function(e){var t,n,r,i,o,s,a,c,u,l,d=this,f=d.constructor;if(e=new f(e),!d.d||!e.d)return!d.s||!e.s?e=new f(NaN):d.d||(e=new f(e.d||d.s===e.s?d:NaN)),e;if(d.s!=e.s)return e.s=-e.s,d.minus(e);if(u=d.d,l=e.d,a=f.precision,c=f.rounding,!u[0]||!l[0])return l[0]||(e=new f(d)),b?h(e,a,c):e;if(o=q(d.e/w),r=q(e.e/w),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,r=o,s=u.length),o=Math.ceil(a/w),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/Q|0,u[i]%=Q;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=Ne(u,r),b?h(e,a,c):e};m.precision=m.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(oe+e);return n.d?(t=Ct(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};m.round=function(){var e=this,t=e.constructor;return h(new t(e),e.e+1,t.rounding)};m.sine=m.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+w,r.rounding=1,n=Rn(r,_t(r,n)),r.precision=e,r.rounding=t,h(Y>2?n.neg():n,e,t,!0)):new r(NaN)};m.squareRoot=m.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(b=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=U(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=q((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(C(s,o,n+2,1)).times(.5),U(o.d).slice(0,n)===(t=U(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(h(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(h(r,c+1,1),e=!r.times(r).eq(s));break}return b=!0,h(r,c,l.rounding,e)};m.tangent=m.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=C(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,h(Y==2||Y==4?n.neg():n,e,t,!0)):new r(NaN)};m.times=m.mul=function(e){var t,n,r,i,o,s,a,c,u,l=this,d=l.constructor,f=l.d,p=(e=new d(e)).d;if(e.s*=l.s,!f||!f[0]||!p||!p[0])return new d(!e.s||f&&!f[0]&&!p||p&&!p[0]&&!f?NaN:!f||!p?e.s/0:e.s*0);for(n=q(l.e/w)+q(e.e/w),c=f.length,u=p.length,c<u&&(o=f,f=p,p=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+p[r]*f[i-r-1]+t,o[i--]=a%Q|0,t=a/Q|0;o[i]=(o[i]+t)%Q|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=Ne(o,n),b?h(e,d.precision,d.rounding):e};m.toBinary=function(e,t){return tt(this,2,e,t)};m.toDecimalPlaces=m.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(H(e,0,se),t===void 0?t=r.rounding:H(t,0,8),h(n,e+n.e+1,t))};m.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=X(r,!0):(H(e,0,se),t===void 0?t=i.rounding:H(t,0,8),r=h(new i(r),e+1,t),n=X(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=X(i):(H(e,0,se),t===void 0?t=o.rounding:H(t,0,8),r=h(new o(i),e+i.e+1,t),n=X(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};m.toFraction=function(e){var t,n,r,i,o,s,a,c,u,l,d,f,p=this,x=p.d,y=p.constructor;if(!x)return new y(p);if(u=n=new y(1),r=c=new y(0),t=new y(r),o=t.e=Ct(x)-p.e-1,s=o%w,t.d[0]=V(10,s<0?w+s:s),e==null)e=o>0?t:u;else{if(a=new y(e),!a.isInt()||a.lt(u))throw Error(oe+a);e=a.gt(t)?o>0?t:u:a}for(b=!1,a=new y(U(x)),l=y.precision,y.precision=o=x.length*w*2;d=C(a,t,0,1,1),i=n.plus(d.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(d.times(i)),c=i,i=t,t=a.minus(d.times(i)),a=i;return i=C(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=p.s,f=C(u,r,o,1).minus(p).abs().cmp(C(c,n,o,1).minus(p).abs())<1?[u,r]:[c,n],y.precision=l,b=!0,f};m.toHexadecimal=m.toHex=function(e,t){return tt(this,16,e,t)};m.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:H(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(b=!1,n=C(n,e,0,t,1).times(e),b=!0,h(n)):(e.s=n.s,n=e),n};m.toNumber=function(){return+this};m.toOctal=function(e,t){return tt(this,8,e,t)};m.toPower=m.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(V(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return h(a,r,o);if(t=q(e.e/w),t>=e.d.length-1&&(n=u<0?-u:u)<=Bn)return i=Rt(c,a,n,r),e.s<0?new c(1).div(i):h(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=V(+a,u),t=n==0||!isFinite(n)?q(u*(Math.log("0."+U(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(b=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=$e(e.times(ie(a,r+n)),r),i.d&&(i=h(i,r+5,1),ge(i.d,r,o)&&(t=r+10,i=h($e(e.times(ie(a,t+n)),t),t+5,1),+U(i.d).slice(r+1,r+15)+1==1e14&&(i=h(i,r+1,0)))),i.s=s,b=!0,c.rounding=o,h(i,r,o))};m.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=X(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(H(e,1,se),t===void 0?t=i.rounding:H(t,0,8),r=h(new i(r),e,t),n=X(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};m.toSignificantDigits=m.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(H(e,1,se),t===void 0?t=r.rounding:H(t,0,8)),h(new r(n),e,t)};m.toString=function(){var e=this,t=e.constructor,n=X(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};m.truncated=m.trunc=function(){return h(new this.constructor(this),this.e+1,1)};m.valueOf=m.toJSON=function(){var e=this,t=e.constructor,n=X(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function U(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=w-r.length,n&&(o+=re(n)),o+=r;s=e[t],r=s+"",n=w-r.length,n&&(o+=re(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function H(e,t,n){if(e!==~~e||e<t||e>n)throw Error(oe+e)}function ge(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=w,i=0):(i=Math.ceil((t+1)/w),t%=w),o=V(10,w-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==V(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==V(10,t-3)-1,s}function Be(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=Xe.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function In(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/Me(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=de(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var C=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,l,d,f,p,x,y,B,S,E,I,D,Pe,J,qe,Se,pe,Ge,Z,Le,Ae=r.constructor,He=r.s==i.s?1:-1,W=r.d,R=i.d;if(!W||!W[0]||!R||!R[0])return new Ae(!r.s||!i.s||(W?R&&W[0]==R[0]:!R)?NaN:W&&W[0]==0||!R?He*0:He/0);for(c?(p=1,l=r.e-i.e):(c=Q,p=w,l=q(r.e/p)-q(i.e/p)),Z=R.length,pe=W.length,S=new Ae(He),E=S.d=[],d=0;R[d]==(W[d]||0);d++);if(R[d]>(W[d]||0)&&l--,o==null?(J=o=Ae.precision,s=Ae.rounding):a?J=o+(r.e-i.e)+1:J=o,J<0)E.push(1),x=!0;else{if(J=J/p+2|0,d=0,Z==1){for(f=0,R=R[0],J++;(d<pe||f)&&J--;d++)qe=f*c+(W[d]||0),E[d]=qe/R|0,f=qe%R|0;x=f||d<pe}else{for(f=c/(R[0]+1)|0,f>1&&(R=e(R,f,c),W=e(W,f,c),Z=R.length,pe=W.length),Se=Z,I=W.slice(0,Z),D=I.length;D<Z;)I[D++]=0;Le=R.slice(),Le.unshift(0),Ge=R[0],R[1]>=c/2&&++Ge;do f=0,u=t(R,I,Z,D),u<0?(Pe=I[0],Z!=D&&(Pe=Pe*c+(I[1]||0)),f=Pe/Ge|0,f>1?(f>=c&&(f=c-1),y=e(R,f,c),B=y.length,D=I.length,u=t(y,I,B,D),u==1&&(f--,n(y,Z<B?Le:R,B,c))):(f==0&&(u=f=1),y=R.slice()),B=y.length,B<D&&y.unshift(0),n(I,y,D,c),u==-1&&(D=I.length,u=t(R,I,Z,D),u<1&&(f++,n(I,Z<D?Le:R,D,c))),D=I.length):u===0&&(f++,I=[0]),E[d++]=f,u&&I[0]?I[D++]=W[Se]||0:(I=[W[Se]],D=1);while((Se++<pe||I[0]!==void 0)&&J--);x=I[0]!==void 0}E[0]||E.shift()}if(p==1)S.e=l,Lt=x;else{for(d=1,f=E[0];f>=10;f/=10)d++;S.e=d+l*p-1,h(S,a?o+S.e+1:o,s,x)}return S}}();function h(e,t,n,r){var i,o,s,a,c,u,l,d,f,p=e.constructor;e:if(t!=null){if(d=e.d,!d)return e;for(i=1,a=d[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=w,s=t,l=d[f=0],c=l/V(10,i-s-1)%10|0;else if(f=Math.ceil((o+1)/w),a=d.length,f>=a)if(r){for(;a++<=f;)d.push(0);l=c=0,i=1,o%=w,s=o-w+1}else break e;else{for(l=a=d[f],i=1;a>=10;a/=10)i++;o%=w,s=o-w+i,c=s<0?0:l/V(10,i-s-1)%10|0}if(r=r||t<0||d[f+1]!==void 0||(s<0?l:l%V(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/V(10,i-s):0:d[f-1])%10&1||n==(e.s<0?8:7)),t<1||!d[0])return d.length=0,u?(t-=e.e+1,d[0]=V(10,(w-t%w)%w),e.e=-t||0):d[0]=e.e=0,e;if(o==0?(d.length=f,a=1,f--):(d.length=f+1,a=V(10,w-o),d[f]=s>0?(l/V(10,i-s)%V(10,s)|0)*a:0),u)for(;;)if(f==0){for(o=1,s=d[0];s>=10;s/=10)o++;for(s=d[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,d[0]==Q&&(d[0]=1));break}else{if(d[f]+=a,d[f]!=Q)break;d[f--]=0,a=1}for(o=d.length;d[--o]===0;)d.pop()}return b&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function X(e,t,n){if(!e.isFinite())return Mt(e);var r,i=e.e,o=U(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+re(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+re(-i-1)+o,n&&(r=n-s)>0&&(o+=re(r))):i>=s?(o+=re(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+re(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=re(r))),o}function Ne(e,t){var n=e[0];for(t*=w;n>=10;n/=10)t++;return t}function Ce(e,t,n){if(t>kn)throw b=!0,n&&(e.precision=n),Error(At);return h(new e(ke),t,1,!0)}function z(e,t,n){if(t>Ye)throw Error(At);return h(new e(Ie),t,n,!0)}function Ct(e){var t=e.length-1,n=t*w+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function re(e){for(var t="";e--;)t+="0";return t}function Rt(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/w+4);for(b=!1;;){if(n%2&&(o=o.times(t),Pt(o.d,s)&&(i=!0)),n=q(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),Pt(t.d,s)}return b=!0,o}function xt(e){return e.d[e.d.length-1]&1}function Nt(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function $e(e,t){var n,r,i,o,s,a,c,u=0,l=0,d=0,f=e.constructor,p=f.rounding,x=f.precision;if(!e.d||!e.d[0]||e.e>17)return new f(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(b=!1,c=x):c=t,a=new f(.03125);e.e>-2;)e=e.times(a),d+=5;for(r=Math.log(V(2,d))/Math.LN10*2+5|0,c+=r,n=o=s=new f(1),f.precision=c;;){if(o=h(o.times(e),c,1),n=n.times(++l),a=s.plus(C(o,n,c,1)),U(a.d).slice(0,c)===U(s.d).slice(0,c)){for(i=d;i--;)s=h(s.times(s),c,1);if(t==null)if(u<3&&ge(s.d,c-r,p,u))f.precision=c+=10,n=o=a=new f(1),l=0,u++;else return h(s,f.precision=x,p,b=!0);else return f.precision=x,s}s=a}}function ie(e,t){var n,r,i,o,s,a,c,u,l,d,f,p=1,x=10,y=e,B=y.d,S=y.constructor,E=S.rounding,I=S.precision;if(y.s<0||!B||!B[0]||!y.e&&B[0]==1&&B.length==1)return new S(B&&!B[0]?-1/0:y.s!=1?NaN:B?0:y);if(t==null?(b=!1,l=I):l=t,S.precision=l+=x,n=U(B),r=n.charAt(0),Math.abs(o=y.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)y=y.times(e),n=U(y.d),r=n.charAt(0),p++;o=y.e,r>1?(y=new S("0."+n),o++):y=new S(r+"."+n.slice(1))}else return u=Ce(S,l+2,I).times(o+""),y=ie(new S(r+"."+n.slice(1)),l-x).plus(u),S.precision=I,t==null?h(y,I,E,b=!0):y;for(d=y,c=s=y=C(y.minus(1),y.plus(1),l,1),f=h(y.times(y),l,1),i=3;;){if(s=h(s.times(f),l,1),u=c.plus(C(s,new S(i),l,1)),U(u.d).slice(0,l)===U(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(Ce(S,l+2,I).times(o+""))),c=C(c,new S(p),l,1),t==null)if(ge(c.d,l-x,E,a))S.precision=l+=x,u=s=y=C(d.minus(1),d.plus(1),l,1),f=h(y.times(y),l,1),i=a=1;else return h(c,S.precision=I,E,b=!0);else return S.precision=I,c;c=u,i+=2}}function Mt(e){return String(e.s*e.s/0)}function et(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%w,n<0&&(r+=w),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=w;r<i;)e.d.push(+t.slice(r,r+=w));t=t.slice(r),r=w-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),b&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Cn(e,t){var n,r,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),It.test(t))return et(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Ln.test(t))n=16,t=t.toLowerCase();else if(Sn.test(t))n=2;else if(An.test(t))n=8;else throw Error(oe+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Rt(r,new r(n),o,o*2)),u=Be(t,n,Q),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=Ne(u,l),e.d=u,b=!1,s&&(e=C(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?V(2,c):_e.pow(2,c))),b=!0,e)}function Rn(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:de(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/Me(5,n)),t=de(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function de(e,t,n,r,i){var o,s,a,c,u=1,l=e.precision,d=Math.ceil(l/w);for(b=!1,c=n.times(n),a=new e(r);;){if(s=C(a.times(c),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=C(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[d]!==void 0){for(o=d;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return b=!0,s.d.length=d+1,s}function Me(e,t){for(var n=e;--t;)n*=e;return n}function _t(e,t){var n,r=t.s<0,i=z(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return Y=r?4:1,t;if(n=t.divToInt(i),n.isZero())Y=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return Y=xt(n)?r?2:3:r?4:1,t;Y=xt(n)?r?1:4:r?3:2}return t.minus(i).abs()}function tt(e,t,n,r){var i,o,s,a,c,u,l,d,f,p=e.constructor,x=n!==void 0;if(x?(H(n,1,se),r===void 0?r=p.rounding:H(r,0,8)):(n=p.precision,r=p.rounding),!e.isFinite())l=Mt(e);else{for(l=X(e),s=l.indexOf("."),x?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),f=new p(1),f.e=l.length-s,f.d=Be(X(f),10,i),f.e=f.d.length),d=Be(l,10,i),o=c=d.length;d[--c]==0;)d.pop();if(!d[0])l=x?"0p+0":"0";else{if(s<0?o--:(e=new p(e),e.d=d,e.e=o,e=C(e,f,n,r,0,i),d=e.d,o=e.e,u=Lt),s=d[n],a=i/2,u=u||d[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&d[n-1]&1||r===(e.s<0?8:7)),d.length=n,u)for(;++d[--n]>i-1;)d[n]=0,n||(++o,d.unshift(1));for(c=d.length;!d[c-1];--c);for(s=0,l="";s<c;s++)l+=Xe.charAt(d[s]);if(x){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(d=Be(l,i,t),c=d.length;!d[c-1];--c);for(s=1,l="1.";s<c;s++)l+=Xe.charAt(d[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function Pt(e,t){if(e.length>t)return e.length=t,!0}function Nn(e){return new this(e).abs()}function Mn(e){return new this(e).acos()}function _n(e){return new this(e).acosh()}function vn(e,t){return new this(e).plus(t)}function Fn(e){return new this(e).asin()}function En(e){return new this(e).asinh()}function Vn(e){return new this(e).atan()}function Dn(e){return new this(e).atanh()}function On(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=z(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?z(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=z(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(C(e,t,o,1)),t=z(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(C(e,t,o,1)),n}function Kn(e){return new this(e).cbrt()}function Un(e){return h(e=new this(e),e.e+1,2)}function Wn(e,t,n){return new this(e).clamp(t,n)}function qn(e){if(!e||typeof e!="object")throw Error(Re+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,se,"rounding",0,8,"toExpNeg",-le,0,"toExpPos",0,le,"maxE",0,le,"minE",-le,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=Je[n]),(r=e[n])!==void 0)if(q(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(oe+n+": "+r);if(n="crypto",i&&(this[n]=Je[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Bt);else this[n]=!1;else throw Error(oe+n+": "+r);return this}function Gn(e){return new this(e).cos()}function Hn(e){return new this(e).cosh()}function vt(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,St(o)){u.s=o.s,b?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;b?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return et(u,o.toString())}else if(c!=="string")throw Error(oe+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),It.test(o)?et(u,o):Cn(u,o)}if(i.prototype=m,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=qn,i.clone=vt,i.isDecimal=St,i.abs=Nn,i.acos=Mn,i.acosh=_n,i.add=vn,i.asin=Fn,i.asinh=En,i.atan=Vn,i.atanh=Dn,i.atan2=On,i.cbrt=Kn,i.ceil=Un,i.clamp=Wn,i.cos=Gn,i.cosh=Hn,i.div=jn,i.exp=Zn,i.floor=zn,i.hypot=Qn,i.ln=Xn,i.log=Jn,i.log10=$n,i.log2=Yn,i.max=er,i.min=tr,i.mod=nr,i.mul=rr,i.pow=ir,i.random=or,i.round=sr,i.sign=ar,i.sin=ur,i.sinh=cr,i.sqrt=lr,i.sub=dr,i.sum=fr,i.tan=mr,i.tanh=pr,i.trunc=gr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function jn(e,t){return new this(e).div(t)}function Zn(e){return new this(e).exp()}function zn(e){return h(e=new this(e),e.e+1,3)}function Qn(){var e,t,n=new this(0);for(b=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return b=!0,new this(1/0);n=t}return b=!0,n.sqrt()}function St(e){return e instanceof _e||e&&e.toStringTag===kt||!1}function Xn(e){return new this(e).ln()}function Jn(e,t){return new this(e).log(t)}function Yn(e){return new this(e).log(2)}function $n(e){return new this(e).log(10)}function er(){return Nt(this,arguments,"lt")}function tr(){return Nt(this,arguments,"gt")}function nr(e,t){return new this(e).mod(t)}function rr(e,t){return new this(e).mul(t)}function ir(e,t){return new this(e).pow(t)}function or(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:H(e,1,se),r=Math.ceil(e/w),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Bt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=w,r&&e&&(i=V(10,w-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=w)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<w&&(n-=w-r)}return s.e=n,s.d=a,s}function sr(e){return h(e=new this(e),e.e+1,this.rounding)}function ar(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function ur(e){return new this(e).sin()}function cr(e){return new this(e).sinh()}function lr(e){return new this(e).sqrt()}function dr(e,t){return new this(e).sub(t)}function fr(){var e=0,t=arguments,n=new this(t[e]);for(b=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return b=!0,h(n,this.precision,this.rounding)}function mr(e){return new this(e).tan()}function pr(e){return new this(e).tanh()}function gr(e){return h(e=new this(e),e.e+1,1)}m[Symbol.for("nodejs.util.inspect.custom")]=m.toString;m[Symbol.toStringTag]="Decimal";var _e=m.constructor=vt(Je);ke=new _e(ke);Ie=new _e(Ie);import Sr from"big.js";import Ee from"bn.js";import hr from"toformat";var wr=hr,he=wr;import Fe from"big.js";import br from"bn.js";import Tr from"decimal.js-light";import we from"bn.js";var Ft=9007199254740991;function v(e){let t=K("Raydium_parseBigNumberish");if(e instanceof we)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new we(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Ft||e<=-Ft)&&t.logWithError(`BigNumberish number overflow: ${e}`),new we(String(e))):typeof e=="bigint"?new we(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new we(0))}var ve=K("module/fraction"),nt=he(Fe),ye=he(Tr),xr={[0]:ye.ROUND_DOWN,[1]:ye.ROUND_HALF_UP,[2]:ye.ROUND_UP},Pr={[0]:Fe.roundDown,[1]:Fe.roundHalfUp,[2]:Fe.roundUp},k=class{constructor(t,n=new br(1)){this.numerator=v(t),this.denominator=v(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new k(this.denominator,this.numerator)}add(t){let n=t instanceof k?t:new k(v(t));return this.denominator.eq(n.denominator)?new k(this.numerator.add(n.numerator),this.denominator):new k(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof k?t:new k(v(t));return this.denominator.eq(n.denominator)?new k(this.numerator.sub(n.numerator),this.denominator):new k(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof k?t:new k(v(t));return new k(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof k?t:new k(v(t));return new k(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||ve.logWithError(`${t} is not an integer.`),t<=0&&ve.logWithError(`${t} is not positive.`),ye.set({precision:t+1,rounding:xr[r]});let i=new ye(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||ve.logWithError(`${t} is not an integer.`),t<0&&ve.logWithError(`${t} is negative.`),nt.DP=t,nt.RM=Pr[r]||1,new nt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var Lr=K("Raydium_amount"),Et=he(Sr);function Ar(e,t){let n="0",r="0";if(e.includes(".")){let i=e.split(".");i.length===2?([n,r]=i,r=r.padEnd(t,"0")):Lr.logWithError(`invalid number string, num: ${e}`)}else n=e;return[n,r.slice(0,t)||r]}var $=class extends k{constructor(n,r,i=!0,o){let s=new Ee(0),a=rt.pow(new Ee(n.decimals));if(i)s=v(r);else{let c=new Ee(0),u=new Ee(0);if(typeof r=="string"||typeof r=="number"||typeof r=="bigint"){let[l,d]=Ar(r.toString(),n.decimals);c=v(l),u=v(d)}c=c.mul(a),s=c.add(u)}super(s,a);this.logger=K(o||"TokenAmount"),this.token=n}get raw(){return this.numerator}isZero(){return this.raw.isZero()}gt(n){return this.token.equals(n.token)||this.logger.logWithError("gt token not equals"),this.raw.gt(n.raw)}lt(n){return this.token.equals(n.token)||this.logger.logWithError("lt token not equals"),this.raw.lt(n.raw)}add(n){return this.token.equals(n.token)||this.logger.logWithError("add token not equals"),new $(this.token,this.raw.add(n.raw))}subtract(n){return this.token.equals(n.token)||this.logger.logWithError("sub token not equals"),new $(this.token,this.raw.sub(n.raw))}toSignificant(n=this.token.decimals,r,i=0){return super.toSignificant(n,r,i)}toFixed(n=this.token.decimals,r,i=0){return n>this.token.decimals&&this.logger.logWithError("decimals overflow"),super.toFixed(n,r,i)}toExact(n={groupSeparator:""}){return Et.DP=this.token.decimals,new Et(this.numerator.toString()).div(this.denominator.toString()).toFormat(n)}};import{PublicKey as Br}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Vt}from"@solana/spl-token";var Dt={chainId:101,address:Br.default.toBase58(),programId:Vt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},ae={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Vt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as st}from"@solana/web3.js";import{PublicKey as N,SystemProgram as Ot,SYSVAR_RENT_PUBKEY as kr}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Ir}from"@solana/spl-token";function it({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var so=[it({pubkey:Ir,isWritable:!1}),it({pubkey:Ot.programId,isWritable:!1}),it({pubkey:kr,isWritable:!1})];function Kt({publicKey:e,transformSol:t}){let n=ot(e.toString());if(n instanceof N)return t&&n.equals(be)?Qe:n;if(t&&n.toString()===be.toBase58())return Qe;if(typeof n=="string"){if(n===N.default.toBase58())return N.default;try{return new N(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function ot(e){try{return new N(e)}catch{return e}}var ao=new N("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),uo=new N("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),co=new N("SysvarRent111111111111111111111111111111111"),lo=new N("SysvarC1ock11111111111111111111111111111111"),fo=new N("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),mo=new N("Sysvar1nstructions1111111111111111111111111"),po=Ot.programId,go=new N("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),ho=new N("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),wo=new N("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),yo=new N("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),bo=new N("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),To=new N("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),xo=new N("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),Po=new N("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),So=new N("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),Lo=new N("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Ao=new N("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),Qe=new N("So11111111111111111111111111111111111111112"),be=N.default;var at=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===be.toBase58()||t instanceof st&&be.equals(t)){this.decimals=ae.decimals,this.symbol=ae.symbol,this.name=ae.name,this.mint=new st(ae.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?st.default:Kt({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},ue=at;ue.WSOL=new at(G(O({},ae),{mint:ae.address}));var ut=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Ve=ut;Ve.SOL=new ut(Dt);import Cr from"bn.js";var Ut=new k(new Cr(100)),fe=class extends k{toSignificant(t=5,n,r){return this.mul(Ut).toSignificant(t,n,r)}toFixed(t=2,n,r){return this.mul(Ut).toFixed(t,n,r)}};var Rr=K("Raydium_price"),ee=class extends k{constructor(n){let{baseToken:r,quoteToken:i,numerator:o,denominator:s}=n;super(o,s);this.baseToken=r,this.quoteToken=i,this.scalar=new k(ct(r.decimals),ct(i.decimals))}get raw(){return new k(this.numerator,this.denominator)}get adjusted(){return super.mul(this.scalar)}invert(){return new ee({baseToken:this.quoteToken,quoteToken:this.baseToken,denominator:this.numerator,numerator:this.denominator})}mul(n){this.quoteToken!==n.baseToken&&Rr.logWithError("mul token not equals");let r=super.mul(n);return new ee({baseToken:this.baseToken,quoteToken:n.quoteToken,denominator:r.denominator,numerator:r.numerator})}toSignificant(n=this.quoteToken.decimals,r,i){return this.adjusted.toSignificant(n,r,i)}toFixed(n=this.quoteToken.decimals,r,i){return this.adjusted.toFixed(n,r,i)}};import{PublicKey as Mr}from"@solana/web3.js";import _r from"bn.js";function Wt(e){return typeof e=="object"&&e!==null&&![ue,$,Mr,k,_r,ee,fe].some(t=>typeof t=="object"&&e instanceof t)}function De(e){return typeof e=="string"?ot(e):Array.isArray(e)?e.map(t=>De(t)):Wt(e)?Object.fromEntries(Object.entries(e).map(([t,n])=>[t,De(n)])):e}var Nr=new te(0),xs=new te(1),Ps=new te(2),Ss=new te(3),Ls=new te(5),rt=new te(10),As=new te(100),Bs=new te(1e3),ks=new te(1e4);function ct(e){return rt.pow(v(e))}var qt=e=>typeof e=="number";function Gt(e,t,n){let r=qt(t)?t*((n==null?void 0:n.unit)==="s"?1e3:1):t;return new Date(e).getTime()<=r}function Ht(e,t,n){let r=qt(t)?t*((n==null?void 0:n.unit)==="s"?1e3:1):t;return new Date(e).getTime()>r}function ze(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as Js}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as $s}from"@solana/spl-token";import{ComputeBudgetProgram as Fs,Keypair as Ds,PublicKey as Fr,Transaction as Ks,TransactionMessage as Ws,VersionedTransaction as qs}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zs}from"@solana/spl-token";var zs=K("Raydium_txUtil");function Te(e,t){let[n,r]=Fr.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}import{PublicKey as T}from"@solana/web3.js";var jt=new T("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),Zt=new T("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),zt=new T("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),Qt=new T("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),ra=new T("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ia=new T("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),oa=new T("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),sa=new T("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),aa=new T("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),ua=new T("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ca=new T("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),la=new T("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),da=new T("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),fa=new T("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ma=new T("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),pa=new T("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),ga=new T("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ha=new T("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),wa=new T("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ya=new T("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ba=new T("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),Ta=new T("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Er=new T("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Vr=new T("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Dr=new T("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),xa=new T("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),Or=new T("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),Pa=new T("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Kr=new T("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix"),Sa=new T("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),La=new T("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Ur=new T("LanD8FpTBBvzZFXjTxsAoipkFsxPUCDB4qAqKxYDiNP"),Wr=new T("HYNHiyKJ3gGVFvyxJAurK7qr7P2o5J9THmvCGMdULtpW");var Aa={AMM_V4:new T("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AMM_STABLE:new T("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM_PROGRAM_ID:new T("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new T("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new T("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),FARM_PROGRAM_ID_V3:new T("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FARM_PROGRAM_ID_V5:new T("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FARM_PROGRAM_ID_V6:new T("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),OPEN_BOOK_PROGRAM:new T("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:T.default,UTIL1216:T.default,Router:new T("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Er,CREATE_CPMM_POOL_AUTH:Vr,CREATE_CPMM_POOL_FEE_ACC:Dr,LOCK_CPMM_PROGRAM:Or,LOCK_CPMM_AUTH:Kr,LAUNCHPAD_PROGRAM:Ur,LAUNCHPAD_AUTH:Wr,FEE_DESTINATION_ID:new T("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR")};import Ia from"bn.js";import{PublicKey as qr,AddressLookupTableAccount as Xt}from"@solana/web3.js";var Gr={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new Xt({key:new qr("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:Xt.deserialize(Buffer.from("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","base64"))})};import{PublicKey as ja,sendAndConfirmTransaction as Za,SystemProgram as Xa,Transaction as Ja,TransactionMessage as $a,VersionedTransaction as eu}from"@solana/web3.js";import nu from"axios";import Hr from"bn.js";var cu=new Hr(1e6);import{PublicKey as Yr}from"@solana/web3.js";import en,{isBN as tn}from"bn.js";import{bits as Nu,BitStructure as Mu,blob as jr,Blob as _u,cstr as vu,f32 as Fu,f32be as Eu,f64 as Vu,f64be as Du,greedy as Ou,Layout as Zr,ns64 as Ku,ns64be as Uu,nu64 as Wu,nu64be as qu,offset as Gu,s16 as Hu,s16be as ju,s24 as Zu,s24be as zu,s32 as Qu,s32be as Xu,s40 as Ju,s40be as Yu,s48 as $u,s48be as ec,s8 as tc,seq as zr,struct as nc,Structure as Qr,u16 as rc,u16be as ic,u24 as oc,u24be as sc,u32 as ac,u32be as uc,u40 as cc,u40be as lc,u48 as dc,u48be as fc,u8 as Xr,UInt as Jr,union as mc,Union as pc,unionLayoutDiscriminator as gc,utf8 as hc}from"@solana/buffer-layout";var lt=Zr,Jt=Qr;var dt=Jr;var Yt=Xr;var $t=zr;var ce=jr;var me=class extends lt{constructor(n,r,i){super(n,i);this.blob=ce(n),this.signed=r}decode(n,r=0){let i=new en(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new en(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function F(e){return new dt(1,e)}function Ke(e){return new dt(4,e)}function g(e){return new me(8,!1,e)}function ne(e){return new me(16,!1,e)}function nn(e){return new me(1,!0,e)}function Ue(e){return new me(8,!0,e)}var Oe=class extends lt{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function P(e){return new Oe(ce(32),t=>new Yr(t),t=>t.toBuffer(),e)}function mt(e){return new Oe(Yt(),$r,ei,e)}function $r(e){if(e===0)return!1;if(e===1)return!0;throw new Error("Invalid bool: "+e)}function ei(e){return e?1:0}var ft=class extends Jt{decode(t,n){return super.decode(t,n)}};function M(e,t,n){return new ft(e,t,n)}function _(e,t,n){let r,i=typeof t=="number"?t:tn(t)?t.toNumber():new Proxy(t,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=tn(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return $t(e,i,n)}var pt=M([P("mint"),P("owner"),g("amount"),Ke("delegateOption"),P("delegate"),F("state"),Ke("isNativeOption"),g("isNative"),g("delegatedAmount"),Ke("closeAuthorityOption"),P("closeAuthority")]);import{PublicKey as fn}from"@solana/web3.js";var Ec=M([F("instruction")]),Vc=M([F("instruction")]),ti=M([g("rewardState"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardLastUpdateTime"),g("totalReward"),g("totalRewardEmissioned"),g("rewardClaimed"),g("rewardPerSecond"),ne("accRewardPerShare"),P("rewardVault"),P("rewardMint"),P("rewardSender"),g("rewardType"),_(g(),15,"padding")]),ni=M([g("state"),g("nonce"),P("lpVault"),P("rewardVault"),P(),P(),g(),g(),g("totalReward"),ne("perShareReward"),g("lastSlot"),g("perSlotReward")]),ri=M([g("state"),g("nonce"),P("lpVault"),P("rewardVaultA"),g("totalRewardA"),ne("perShareRewardA"),g("perSlotRewardA"),F("option"),P("rewardVaultB"),ce(7),g("totalRewardB"),ne("perShareRewardB"),g("perSlotRewardB"),g("lastSlot"),P()]),ii=M([g(),g("state"),g("nonce"),g("validRewardTokenNum"),ne("rewardMultiplier"),g("rewardPeriodMax"),g("rewardPeriodMin"),g("rewardPeriodExtend"),P("lpMint"),P("lpVault"),_(ti,5,"rewardInfos"),P("creator"),P(),_(g(),32,"padding")]),rn=new Proxy(ni,{get(e,t,n){return t==="decode"?(...r)=>{let i=e.decode(...r);return G(O({},i),{version:3,rewardInfos:[{rewardVault:i.rewardVault,totalReward:i.totalReward,perSlotReward:i.perSlotReward,perShareReward:i.perShareReward}]})}:Reflect.get(e,t,n)}}),on=new Proxy(ri,{get(e,t,n){return t==="decode"?(...r)=>{let i=e.decode(...r);return G(O({},i),{version:5,rewardInfos:[{rewardVault:i.rewardVaultA,totalReward:i.totalRewardA,perSlotReward:i.perSlotRewardA,perShareReward:i.perShareRewardA},{rewardVault:i.rewardVaultB,totalReward:i.totalRewardB,perSlotReward:i.perSlotRewardB,perShareReward:i.perShareRewardB}]})}:Reflect.get(e,t,n)}}),sn=new Proxy(ii,{get(e,t,n){return t==="decode"?(...r)=>{let i=e.decode(...r);return G(O({},i),{version:6,rewardInfos:i.rewardInfos.map(o=>{var s;return G(O({},o),{rewardType:((s=Object.entries(We).find(a=>String(a[1])===o.rewardType.toString()))!=null?s:["Standard SPL"])[0]})})})}:Reflect.get(e,t,n)}}),oi=M([g("isSet"),g("rewardPerSecond"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardType")]),Dc=M([F("instruction"),g("nonce"),_(oi,5,"rewardTimeInfo")]),Oc=M([F("instruction"),g("rewardReopenTime"),g("rewardEndTime"),g("rewardPerSecond")]),Kc=M([F("instruction"),g("isSet"),g("rewardPerSecond"),g("rewardOpenTime"),g("rewardEndTime"),g("rewardType")]),Uc=M([g("state"),P("id"),P("owner"),g("deposited"),_(g(),1,"rewardDebts")]),an=M([g("state"),P("id"),P("owner"),g("deposited"),_(ne(),1,"rewardDebts"),g(""),g("voteLockedBalance"),_(g(),15)]),Wc=M([g("state"),P("id"),P("owner"),g("deposited"),_(g(),2,"rewardDebts")]),un=M([g("state"),P("id"),P("owner"),g("deposited"),_(ne(),2,"rewardDebts"),_(g(),17)]),cn=M([g(),g("state"),P("id"),P("owner"),g("deposited"),_(ne(),5,"rewardDebts"),_(g(),16)]),qc=M([F("instruction"),g("amount")]),si=M([P("mint"),P("grantAuthority"),g("baselineVoteWeightScaledFactor"),g("maxExtraLockupVoteWeightScaledFactor"),g("lockupSaturationSecs"),nn("digitShift"),_(F(),7,"reserved1"),_(g(),7,"reserved2")]),ln=M([ce(8),P("governanceProgramId"),P("realm"),P("realmGoverningTokenMint"),P("realmAuthority"),_(F(),32,"reserved1"),_(si,4,"votingMints"),Ue("timeOffset"),F("bump"),_(F(),7,"reserved2"),_(g(),11,"reserved3")]),ai=M([Ue("startTime"),Ue("endTime"),F("kind"),_(F(),15,"reserved")]),ui=M([_(ai,1,"lockup"),g("amountDeposited_native"),g("amountInitiallyLockedNative"),mt("isUsed"),mt("allowClawback"),F("votingMintConfigIdx"),_(F(),29,"reserved")]),dn=M([ce(8),P("voterAuthority"),P("registrar"),_(ui,32,"deposits"),F("voterBump"),F("voterWweightRecordBump"),_(F(),94,"reserved")]);var Jc=K("Raydium_farm_config"),Yc=new fn("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),$c=new fn("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1"),mn={3:rn,5:on,6:sn},pn={3:an,5:un,6:cn};var We={"Standard SPL":0,"Option tokens":1},el={[jt.toString()]:3,[Zt.toString()]:4,[zt.toString()]:5,[Qt.toString()]:6};var xe=K("Raydium.farm.util");function gl({programId:e,poolId:t,mint:n,type:r}){let{publicKey:i}=Te([t.toBuffer(),n.toBuffer(),Buffer.from(r==="lpVault"?"lp_vault_associated_seed":r==="rewardVault"?"reward_vault_associated_seed":"","utf-8")],e);return i}function ci({programId:e,poolId:t,owner:n,version:r}){let{publicKey:i}=Te([t.toBuffer(),n.toBuffer(),Buffer.from(r===6?"farmer_info_associated_seed":"staker_info_v2_associated_seed","utf-8")],e);return i}var hl=({programId:e,poolId:t})=>Te([t.toBuffer()],e);function wl(e){return{isSet:new j(1),rewardPerSecond:v(e.perSecond),rewardOpenTime:v(e.openTime),rewardEndTime:v(e.endTime),rewardType:v(We[e.rewardType])}}function yl(e){return v(e.endTime).sub(v(e.openTime)).mul(v(e.perSecond))}function li(e){let t=pn[e];return t||xe.logWithError("invalid version",e),t}function di(e){let t=mn[e];return t||xe.logWithError("invalid version",e),t}function fi(e,t,n,r){if(e.version===3||e.version===5){if(e.lastSlot.gte(new j(n)))return e;let i=new j(n).sub(e.lastSlot);e.lastSlot=new j(n);for(let o of e.rewardInfos){if(t.amount.eq(new j(0)))continue;let s=o.perSlotReward.mul(i);o.perShareReward=o.perShareReward.add(s.mul(new j(10).pow(new j(e.version===3?9:15))).div(t.amount)),o.totalReward=o.totalReward.add(s)}}else if(e.version===6)for(let i of e.rewardInfos){if(i.rewardState.eq(new j(0)))continue;let o=j.min(new j(r),i.rewardEndTime);if(i.rewardOpenTime.gte(o))continue;let a=o.sub(i.rewardLastUpdateTime).mul(i.rewardPerSecond),c=i.totalReward.sub(i.totalRewardEmissioned);c.lt(a)?(a=c,i.rewardLastUpdateTime=i.rewardLastUpdateTime.add(c.div(i.rewardPerSecond))):i.rewardLastUpdateTime=o,!t.amount.eq(new j(0))&&(i.accRewardPerShare=i.accRewardPerShare.add(a.mul(e.rewardMultiplier).div(t.amount)),i.totalRewardEmissioned=i.totalRewardEmissioned.add(a))}return e}async function bl({connection:e,farmPools:t,owner:n,config:r,chainTime:i}){let o=!1,s=!1,a=new j(10),c=[];for(let f of t){let p=De(f);p.version===6?s=!0:o=!0,c.push({pubkey:p.id,version:p.version,key:"state",poolId:p.id},{pubkey:p.lpVault,version:p.version,key:"lpVault",poolId:p.id}),n&&c.push({pubkey:ci({programId:p.programId,poolId:p.id,owner:n,version:f.version}),version:p.version,key:"ledger",poolId:p.id})}let u={},l=await Tt(e,c,r);for(let{pubkey:f,version:p,key:x,poolId:y,accountInfo:B}of l){let S=y.toBase58();if(u[S]=O({},u[S]),x==="state"){let E=di(p);(!B||!B.data||B.data.length!==E.span)&&xe.logWithError(`invalid farm state account info, pools.id, ${f}`),u[S].state=E.decode(B.data)}else if(x==="lpVault")(!B||!B.data||B.data.length!==pt.span)&&xe.logWithError(`invalid farm lp vault account info, pools.lpVault, ${f}`),u[S].lpVault=pt.decode(B.data);else if(x==="ledger"){let E=li(p);B&&B.data&&(B.data.length!==E.span&&xe.logWithError(`invalid farm ledger account info, ledger, ${f}`),u[S].ledger=E.decode(B.data))}}let d=s||o?await e.getSlot():0;for(let f of Object.keys(u))u[f]!==void 0&&(u[f].state=fi(u[f].state,u[f].lpVault,d,i));for(let[f,{state:p,ledger:x}]of Object.entries(u))if(x){let y=p.version===6?p.rewardMultiplier:p.rewardInfos.length===1?a.pow(new j(9)):a.pow(new j(15)),B=p.rewardInfos.map((S,E)=>{let I=x.rewardDebts[E];return x.deposited.mul(p.version===6?S.accRewardPerShare:S.perShareReward).div(y).sub(I)});u[f].wrapped=G(O({},u[f].wrapped),{pendingRewards:B})}return u}function Tl(e,t=Date.now()){if(e.version===6){let n=e.state.rewardInfos;if(n.every(({rewardOpenTime:r})=>Gt(t,r.toNumber(),{unit:"s"})))return"upcoming pool";if(n.every(({rewardEndTime:r})=>Ht(t,r.toNumber(),{unit:"s"})))return"closed pool"}else{let n=e.state.rewardInfos.map(({perSlotReward:r})=>r);if(n.length===2){if(String(n[0])==="0"&&String(n[1])!=="0")return"normal fusion pool";if(String(n[0])!=="0"&&String(n[1])!=="0")return"dual fusion pool";if(String(n[0])==="0"&&String(n[1])==="0")return"closed pool"}else if(n.length===1&&String(n[0])==="0")return"closed pool"}}async function xl(e,t,n,r){let i=await e.getAccountInfo(t);if(i===null)throw Error("registrar info check error");let s=ln.decode(i.data).votingMints.findIndex(l=>l.mint.equals(r));if(s===-1)throw Error("find voter mint error");let a=await e.getAccountInfo(n);if(a===null)return{index:s,isInit:!1};let u=dn.decode(a.data).deposits.findIndex(l=>l.isUsed&&l.votingMintConfigIdx===s);return u===-1?{index:s,isInit:!1}:{index:u,isInit:!0}}export{yl as calFarmRewardAmount,wl as farmRewardInfoToConfig,bl as fetchMultipleFarmInfoAndUpdate,hl as getAssociatedAuthority,ci as getAssociatedLedgerAccount,gl as getAssociatedLedgerPoolAccount,xl as getDepositEntryIndex,li as getFarmLedgerLayout,di as getFarmStateLayout,Tl as judgeFarmType,fi as updateFarmPoolInfo};
//# sourceMappingURL=util.mjs.map