var xn=Object.defineProperty,An=Object.defineProperties;var Sn=Object.getOwnPropertyDescriptors;var Fe=Object.getOwnPropertySymbols;var Et=Object.prototype.hasOwnProperty,Mt=Object.prototype.propertyIsEnumerable;var It=(e,t,n)=>t in e?xn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z=(e,t)=>{for(var n in t||(t={}))Et.call(t,n)&&It(e,n,t[n]);if(Fe)for(var n of Fe(t))Mt.call(t,n)&&It(e,n,t[n]);return e},se=(e,t)=>An(e,Sn(t));var Ve=(e,t)=>{var n={};for(var r in e)Et.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&Fe)for(var r of Fe(e))t.indexOf(r)<0&&Mt.call(e,r)&&(n[r]=e[r]);return n};import{PublicKey as ri,Transaction as Bt,TransactionInstruction as ii}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as oi}from"@solana/spl-token";import Tn from"bn.js";import{PublicKey as kn}from"@solana/web3.js";import{get as Dt,set as Ln}from"lodash";var it=class{constructor(t){this.logLevel=t.logLevel!==void 0?t.logLevel:0,this.name=t.name}set level(t){this.logLevel=t}get time(){return Date.now().toString()}get moduleName(){return this.name}isLogLevel(t){return t<=this.logLevel}error(...t){return this.isLogLevel(0)?(console.error(this.time,this.name,"sdk logger error",...t),this):this}logWithError(...t){let n=t.map(r=>typeof r=="object"?JSON.stringify(r):r).join(", ");throw new Error(n)}warning(...t){return this.isLogLevel(1)?(console.warn(this.time,this.name,"sdk logger warning",...t),this):this}info(...t){return this.isLogLevel(2)?(console.info(this.time,this.name,"sdk logger info",...t),this):this}debug(...t){return this.isLogLevel(3)?(console.debug(this.time,this.name,"sdk logger debug",...t),this):this}},Rt={},Cn={};function Z(e){let t=Dt(Rt,e);if(!t){let n=Dt(Cn,e);t=new it({name:e,logLevel:n}),Ln(Rt,e,t)}return t}import{MINT_SIZE as hi,TOKEN_PROGRAM_ID as bi,getTransferFeeConfig as yi,unpackMint as wi}from"@solana/spl-token";var ot=Z("Raydium_accountInfo_util");async function Ke(e,t,n){let{batchRequest:r,commitment:i="confirmed",chunkCount:o=100}=z({batchRequest:!1},n),s=st(t,o),a=new Array(s.length).fill([]);if(r){let c=s.map(f=>{let m=e._buildArgs([f.map(p=>p.toBase58())],i,"base64");return{methodName:"getMultipleAccounts",args:m}}),u=st(c,10);a=(await(await Promise.all(u.map(async f=>await e._rpcBatchRequest(f)))).flat()).map(f=>(f.error&&ot.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${f.error.message}`),f.result.value.map(m=>{if(m){let{data:p,executable:h,lamports:g,owner:b,rentEpoch:P}=m;return p.length!==2&&p[1]!=="base64"&&ot.logWithError("info must be base64 encoded, RPC_ERROR"),{data:Buffer.from(p[0],"base64"),executable:h,lamports:g,owner:new kn(b),rentEpoch:P}}return null})))}else try{a=await Promise.all(s.map(c=>e.getMultipleAccountsInfo(c,i)))}catch(c){c instanceof Error&&ot.logWithError(`failed to get info for multiple accounts, RPC_ERROR, ${c.message}`)}return a.flat()}import oe from"bn.js";var ye=9e15,le=1e9,ut="0123456789abcdef",Ue="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",qe="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",ct={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-ye,maxE:ye,crypto:!1},Ft,re,k=!0,He="[DecimalError] ",ce=He+"Invalid argument: ",Vt=He+"Precision limit exceeded",Kt=He+"crypto unavailable",Wt="[object Decimal]",H=Math.floor,q=Math.pow,Bn=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,Nn=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,In=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,Ut=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,Y=1e7,C=7,En=9007199254740991,Mn=Ue.length-1,lt=qe.length-1,d={toStringTag:Wt};d.absoluteValue=d.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),L(e)};d.ceil=function(){return L(new this.constructor(this),this.e+1,2)};d.clampedTo=d.clamp=function(e,t){var n,r=this,i=r.constructor;if(e=new i(e),t=new i(t),!e.s||!t.s)return new i(NaN);if(e.gt(t))throw Error(ce+t);return n=r.cmp(e),n<0?e:r.cmp(t)>0?t:new i(r)};d.comparedTo=d.cmp=function(e){var t,n,r,i,o=this,s=o.d,a=(e=new o.constructor(e)).d,c=o.s,u=e.s;if(!s||!a)return!c||!u?NaN:c!==u?c:s===a?0:!s^c<0?1:-1;if(!s[0]||!a[0])return s[0]?c:a[0]?-u:0;if(c!==u)return c;if(o.e!==e.e)return o.e>e.e^c<0?1:-1;for(r=s.length,i=a.length,t=0,n=r<i?r:i;t<n;++t)if(s[t]!==a[t])return s[t]>a[t]^c<0?1:-1;return r===i?0:r>i^c<0?1:-1};d.cosine=d.cos=function(){var e,t,n=this,r=n.constructor;return n.d?n.d[0]?(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+C,r.rounding=1,n=Dn(r,zt(r,n)),r.precision=e,r.rounding=t,L(re==2||re==3?n.neg():n,e,t,!0)):new r(1):new r(NaN)};d.cubeRoot=d.cbrt=function(){var e,t,n,r,i,o,s,a,c,u,l=this,f=l.constructor;if(!l.isFinite()||l.isZero())return new f(l);for(k=!1,o=l.s*q(l.s*l,1/3),!o||Math.abs(o)==1/0?(n=G(l.d),e=l.e,(o=(e-n.length+1)%3)&&(n+=o==1||o==-2?"0":"00"),o=q(n,1/3),e=H((e+1)/3)-(e%3==(e<0?-1:2)),o==1/0?n="5e"+e:(n=o.toExponential(),n=n.slice(0,n.indexOf("e")+1)+e),r=new f(n),r.s=l.s):r=new f(o.toString()),s=(e=f.precision)+3;;)if(a=r,c=a.times(a).times(a),u=c.plus(l),r=V(u.plus(l).times(a),u.plus(c),s+2,1),G(a.d).slice(0,s)===(n=G(r.d)).slice(0,s))if(n=n.slice(s-3,s+1),n=="9999"||!i&&n=="4999"){if(!i&&(L(a,e+1,0),a.times(a).times(a).eq(l))){r=a;break}s+=4,i=1}else{(!+n||!+n.slice(1)&&n.charAt(0)=="5")&&(L(r,e+1,1),t=!r.times(r).times(r).eq(l));break}return k=!0,L(r,e,f.rounding,t)};d.decimalPlaces=d.dp=function(){var e,t=this.d,n=NaN;if(t){if(e=t.length-1,n=(e-H(this.e/C))*C,e=t[e],e)for(;e%10==0;e/=10)n--;n<0&&(n=0)}return n};d.dividedBy=d.div=function(e){return V(this,new this.constructor(e))};d.dividedToIntegerBy=d.divToInt=function(e){var t=this,n=t.constructor;return L(V(t,new n(e),0,1,1),n.precision,n.rounding)};d.equals=d.eq=function(e){return this.cmp(e)===0};d.floor=function(){return L(new this.constructor(this),this.e+1,3)};d.greaterThan=d.gt=function(e){return this.cmp(e)>0};d.greaterThanOrEqualTo=d.gte=function(e){var t=this.cmp(e);return t==1||t===0};d.hyperbolicCosine=d.cosh=function(){var e,t,n,r,i,o=this,s=o.constructor,a=new s(1);if(!o.isFinite())return new s(o.s?1/0:NaN);if(o.isZero())return a;n=s.precision,r=s.rounding,s.precision=n+Math.max(o.e,o.sd())+4,s.rounding=1,i=o.d.length,i<32?(e=Math.ceil(i/3),t=(1/ze(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),o=we(s,1,o.times(t),new s(1),!0);for(var c,u=e,l=new s(8);u--;)c=o.times(o),o=a.minus(c.times(l.minus(c.times(l))));return L(o,s.precision=n,s.rounding=r,!0)};d.hyperbolicSine=d.sinh=function(){var e,t,n,r,i=this,o=i.constructor;if(!i.isFinite()||i.isZero())return new o(i);if(t=o.precision,n=o.rounding,o.precision=t+Math.max(i.e,i.sd())+4,o.rounding=1,r=i.d.length,r<3)i=we(o,2,i,i,!0);else{e=1.4*Math.sqrt(r),e=e>16?16:e|0,i=i.times(1/ze(5,e)),i=we(o,2,i,i,!0);for(var s,a=new o(5),c=new o(16),u=new o(20);e--;)s=i.times(i),i=i.times(a.plus(s.times(c.times(s).plus(u))))}return o.precision=t,o.rounding=n,L(i,t,n,!0)};d.hyperbolicTangent=d.tanh=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+7,r.rounding=1,V(n.sinh(),n.cosh(),r.precision=e,r.rounding=t)):new r(n.s)};d.inverseCosine=d.acos=function(){var e,t=this,n=t.constructor,r=t.abs().cmp(1),i=n.precision,o=n.rounding;return r!==-1?r===0?t.isNeg()?X(n,i,o):new n(0):new n(NaN):t.isZero()?X(n,i+4,o).times(.5):(n.precision=i+6,n.rounding=1,t=t.asin(),e=X(n,i+4,o).times(.5),n.precision=i,n.rounding=o,e.minus(t))};d.inverseHyperbolicCosine=d.acosh=function(){var e,t,n=this,r=n.constructor;return n.lte(1)?new r(n.eq(1)?0:NaN):n.isFinite()?(e=r.precision,t=r.rounding,r.precision=e+Math.max(Math.abs(n.e),n.sd())+4,r.rounding=1,k=!1,n=n.times(n).minus(1).sqrt().plus(n),k=!0,r.precision=e,r.rounding=t,n.ln()):new r(n)};d.inverseHyperbolicSine=d.asinh=function(){var e,t,n=this,r=n.constructor;return!n.isFinite()||n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+2*Math.max(Math.abs(n.e),n.sd())+6,r.rounding=1,k=!1,n=n.times(n).plus(1).sqrt().plus(n),k=!0,r.precision=e,r.rounding=t,n.ln())};d.inverseHyperbolicTangent=d.atanh=function(){var e,t,n,r,i=this,o=i.constructor;return i.isFinite()?i.e>=0?new o(i.abs().eq(1)?i.s/0:i.isZero()?i:NaN):(e=o.precision,t=o.rounding,r=i.sd(),Math.max(r,e)<2*-i.e-1?L(new o(i),e,t,!0):(o.precision=n=r-i.e,i=V(i.plus(1),new o(1).minus(i),n+e,1),o.precision=e+4,o.rounding=1,i=i.ln(),o.precision=e,o.rounding=t,i.times(.5))):new o(NaN)};d.inverseSine=d.asin=function(){var e,t,n,r,i=this,o=i.constructor;return i.isZero()?new o(i):(t=i.abs().cmp(1),n=o.precision,r=o.rounding,t!==-1?t===0?(e=X(o,n+4,r).times(.5),e.s=i.s,e):new o(NaN):(o.precision=n+6,o.rounding=1,i=i.div(new o(1).minus(i.times(i)).sqrt().plus(1)).atan(),o.precision=n,o.rounding=r,i.times(2)))};d.inverseTangent=d.atan=function(){var e,t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,m=l.rounding;if(u.isFinite()){if(u.isZero())return new l(u);if(u.abs().eq(1)&&f+4<=lt)return s=X(l,f+4,m).times(.25),s.s=u.s,s}else{if(!u.s)return new l(NaN);if(f+4<=lt)return s=X(l,f+4,m).times(.5),s.s=u.s,s}for(l.precision=a=f+10,l.rounding=1,n=Math.min(28,a/C+2|0),e=n;e;--e)u=u.div(u.times(u).plus(1).sqrt().plus(1));for(k=!1,t=Math.ceil(a/C),r=1,c=u.times(u),s=new l(u),i=u;e!==-1;)if(i=i.times(c),o=s.minus(i.div(r+=2)),i=i.times(c),s=o.plus(i.div(r+=2)),s.d[t]!==void 0)for(e=t;s.d[e]===o.d[e]&&e--;);return n&&(s=s.times(2<<n-1)),k=!0,L(s,l.precision=f,l.rounding=m,!0)};d.isFinite=function(){return!!this.d};d.isInteger=d.isInt=function(){return!!this.d&&H(this.e/C)>this.d.length-2};d.isNaN=function(){return!this.s};d.isNegative=d.isNeg=function(){return this.s<0};d.isPositive=d.isPos=function(){return this.s>0};d.isZero=function(){return!!this.d&&this.d[0]===0};d.lessThan=d.lt=function(e){return this.cmp(e)<0};d.lessThanOrEqualTo=d.lte=function(e){return this.cmp(e)<1};d.logarithm=d.log=function(e){var t,n,r,i,o,s,a,c,u=this,l=u.constructor,f=l.precision,m=l.rounding,p=5;if(e==null)e=new l(10),t=!0;else{if(e=new l(e),n=e.d,e.s<0||!n||!n[0]||e.eq(1))return new l(NaN);t=e.eq(10)}if(n=u.d,u.s<0||!n||!n[0]||u.eq(1))return new l(n&&!n[0]?-1/0:u.s!=1?NaN:n?0:1/0);if(t)if(n.length>1)o=!0;else{for(i=n[0];i%10===0;)i/=10;o=i!==1}if(k=!1,a=f+p,s=ue(u,a),r=t?Ge(l,a+10):ue(e,a),c=V(s,r,a,1),Se(c.d,i=f,m))do if(a+=10,s=ue(u,a),r=t?Ge(l,a+10):ue(e,a),c=V(s,r,a,1),!o){+G(c.d).slice(i+1,i+15)+1==1e14&&(c=L(c,f+1,0));break}while(Se(c.d,i+=10,m));return k=!0,L(c,f,m)};d.minus=d.sub=function(e){var t,n,r,i,o,s,a,c,u,l,f,m,p=this,h=p.constructor;if(e=new h(e),!p.d||!e.d)return!p.s||!e.s?e=new h(NaN):p.d?e.s=-e.s:e=new h(e.d||p.s!==e.s?p:NaN),e;if(p.s!=e.s)return e.s=-e.s,p.plus(e);if(u=p.d,m=e.d,a=h.precision,c=h.rounding,!u[0]||!m[0]){if(m[0])e.s=-e.s;else if(u[0])e=new h(p);else return new h(c===3?-0:0);return k?L(e,a,c):e}if(n=H(e.e/C),l=H(p.e/C),u=u.slice(),o=l-n,o){for(f=o<0,f?(t=u,o=-o,s=m.length):(t=m,n=l,s=u.length),r=Math.max(Math.ceil(a/C),s)+2,o>r&&(o=r,t.length=1),t.reverse(),r=o;r--;)t.push(0);t.reverse()}else{for(r=u.length,s=m.length,f=r<s,f&&(s=r),r=0;r<s;r++)if(u[r]!=m[r]){f=u[r]<m[r];break}o=0}for(f&&(t=u,u=m,m=t,e.s=-e.s),s=u.length,r=m.length-s;r>0;--r)u[s++]=0;for(r=m.length;r>o;){if(u[--r]<m[r]){for(i=r;i&&u[--i]===0;)u[i]=Y-1;--u[i],u[r]+=Y}u[r]-=m[r]}for(;u[--s]===0;)u.pop();for(;u[0]===0;u.shift())--n;return u[0]?(e.d=u,e.e=je(u,n),k?L(e,a,c):e):new h(c===3?-0:0)};d.modulo=d.mod=function(e){var t,n=this,r=n.constructor;return e=new r(e),!n.d||!e.s||e.d&&!e.d[0]?new r(NaN):!e.d||n.d&&!n.d[0]?L(new r(n),r.precision,r.rounding):(k=!1,r.modulo==9?(t=V(n,e.abs(),0,3,1),t.s*=e.s):t=V(n,e,0,r.modulo,1),t=t.times(e),k=!0,n.minus(t))};d.naturalExponential=d.exp=function(){return ft(this)};d.naturalLogarithm=d.ln=function(){return ue(this)};d.negated=d.neg=function(){var e=new this.constructor(this);return e.s=-e.s,L(e)};d.plus=d.add=function(e){var t,n,r,i,o,s,a,c,u,l,f=this,m=f.constructor;if(e=new m(e),!f.d||!e.d)return!f.s||!e.s?e=new m(NaN):f.d||(e=new m(e.d||f.s===e.s?f:NaN)),e;if(f.s!=e.s)return e.s=-e.s,f.minus(e);if(u=f.d,l=e.d,a=m.precision,c=m.rounding,!u[0]||!l[0])return l[0]||(e=new m(f)),k?L(e,a,c):e;if(o=H(f.e/C),r=H(e.e/C),u=u.slice(),i=o-r,i){for(i<0?(n=u,i=-i,s=l.length):(n=l,r=o,s=u.length),o=Math.ceil(a/C),s=o>s?o+1:s+1,i>s&&(i=s,n.length=1),n.reverse();i--;)n.push(0);n.reverse()}for(s=u.length,i=l.length,s-i<0&&(i=s,n=l,l=u,u=n),t=0;i;)t=(u[--i]=u[i]+l[i]+t)/Y|0,u[i]%=Y;for(t&&(u.unshift(t),++r),s=u.length;u[--s]==0;)u.pop();return e.d=u,e.e=je(u,r),k?L(e,a,c):e};d.precision=d.sd=function(e){var t,n=this;if(e!==void 0&&e!==!!e&&e!==1&&e!==0)throw Error(ce+e);return n.d?(t=qt(n.d),e&&n.e+1>t&&(t=n.e+1)):t=NaN,t};d.round=function(){var e=this,t=e.constructor;return L(new t(e),e.e+1,t.rounding)};d.sine=d.sin=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+Math.max(n.e,n.sd())+C,r.rounding=1,n=On(r,zt(r,n)),r.precision=e,r.rounding=t,L(re>2?n.neg():n,e,t,!0)):new r(NaN)};d.squareRoot=d.sqrt=function(){var e,t,n,r,i,o,s=this,a=s.d,c=s.e,u=s.s,l=s.constructor;if(u!==1||!a||!a[0])return new l(!u||u<0&&(!a||a[0])?NaN:a?s:1/0);for(k=!1,u=Math.sqrt(+s),u==0||u==1/0?(t=G(a),(t.length+c)%2==0&&(t+="0"),u=Math.sqrt(t),c=H((c+1)/2)-(c<0||c%2),u==1/0?t="5e"+c:(t=u.toExponential(),t=t.slice(0,t.indexOf("e")+1)+c),r=new l(t)):r=new l(u.toString()),n=(c=l.precision)+3;;)if(o=r,r=o.plus(V(s,o,n+2,1)).times(.5),G(o.d).slice(0,n)===(t=G(r.d)).slice(0,n))if(t=t.slice(n-3,n+1),t=="9999"||!i&&t=="4999"){if(!i&&(L(o,c+1,0),o.times(o).eq(s))){r=o;break}n+=4,i=1}else{(!+t||!+t.slice(1)&&t.charAt(0)=="5")&&(L(r,c+1,1),e=!r.times(r).eq(s));break}return k=!0,L(r,c,l.rounding,e)};d.tangent=d.tan=function(){var e,t,n=this,r=n.constructor;return n.isFinite()?n.isZero()?new r(n):(e=r.precision,t=r.rounding,r.precision=e+10,r.rounding=1,n=n.sin(),n.s=1,n=V(n,new r(1).minus(n.times(n)).sqrt(),e+10,0),r.precision=e,r.rounding=t,L(re==2||re==4?n.neg():n,e,t,!0)):new r(NaN)};d.times=d.mul=function(e){var t,n,r,i,o,s,a,c,u,l=this,f=l.constructor,m=l.d,p=(e=new f(e)).d;if(e.s*=l.s,!m||!m[0]||!p||!p[0])return new f(!e.s||m&&!m[0]&&!p||p&&!p[0]&&!m?NaN:!m||!p?e.s/0:e.s*0);for(n=H(l.e/C)+H(e.e/C),c=m.length,u=p.length,c<u&&(o=m,m=p,p=o,s=c,c=u,u=s),o=[],s=c+u,r=s;r--;)o.push(0);for(r=u;--r>=0;){for(t=0,i=c+r;i>r;)a=o[i]+p[r]*m[i-r-1]+t,o[i--]=a%Y|0,t=a/Y|0;o[i]=(o[i]+t)%Y|0}for(;!o[--s];)o.pop();return t?++n:o.shift(),e.d=o,e.e=je(o,n),k?L(e,f.precision,f.rounding):e};d.toBinary=function(e,t){return dt(this,2,e,t)};d.toDecimalPlaces=d.toDP=function(e,t){var n=this,r=n.constructor;return n=new r(n),e===void 0?n:(J(e,0,le),t===void 0?t=r.rounding:J(t,0,8),L(n,e+n.e+1,t))};d.toExponential=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=$(r,!0):(J(e,0,le),t===void 0?t=i.rounding:J(t,0,8),r=L(new i(r),e+1,t),n=$(r,!0,e+1)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toFixed=function(e,t){var n,r,i=this,o=i.constructor;return e===void 0?n=$(i):(J(e,0,le),t===void 0?t=o.rounding:J(t,0,8),r=L(new o(i),e+i.e+1,t),n=$(r,!1,e+r.e+1)),i.isNeg()&&!i.isZero()?"-"+n:n};d.toFraction=function(e){var t,n,r,i,o,s,a,c,u,l,f,m,p=this,h=p.d,g=p.constructor;if(!h)return new g(p);if(u=n=new g(1),r=c=new g(0),t=new g(r),o=t.e=qt(h)-p.e-1,s=o%C,t.d[0]=q(10,s<0?C+s:s),e==null)e=o>0?t:u;else{if(a=new g(e),!a.isInt()||a.lt(u))throw Error(ce+a);e=a.gt(t)?o>0?t:u:a}for(k=!1,a=new g(G(h)),l=g.precision,g.precision=o=h.length*C*2;f=V(a,t,0,1,1),i=n.plus(f.times(r)),i.cmp(e)!=1;)n=r,r=i,i=u,u=c.plus(f.times(i)),c=i,i=t,t=a.minus(f.times(i)),a=i;return i=V(e.minus(n),r,0,1,1),c=c.plus(i.times(u)),n=n.plus(i.times(r)),c.s=u.s=p.s,m=V(u,r,o,1).minus(p).abs().cmp(V(c,n,o,1).minus(p).abs())<1?[u,r]:[c,n],g.precision=l,k=!0,m};d.toHexadecimal=d.toHex=function(e,t){return dt(this,16,e,t)};d.toNearest=function(e,t){var n=this,r=n.constructor;if(n=new r(n),e==null){if(!n.d)return n;e=new r(1),t=r.rounding}else{if(e=new r(e),t===void 0?t=r.rounding:J(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(k=!1,n=V(n,e,0,t,1).times(e),k=!0,L(n)):(e.s=n.s,n=e),n};d.toNumber=function(){return+this};d.toOctal=function(e,t){return dt(this,8,e,t)};d.toPower=d.pow=function(e){var t,n,r,i,o,s,a=this,c=a.constructor,u=+(e=new c(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new c(q(+a,u));if(a=new c(a),a.eq(1))return a;if(r=c.precision,o=c.rounding,e.eq(1))return L(a,r,o);if(t=H(e.e/C),t>=e.d.length-1&&(n=u<0?-u:u)<=En)return i=Gt(c,a,n,r),e.s<0?new c(1).div(i):L(i,r,o);if(s=a.s,s<0){if(t<e.d.length-1)return new c(NaN);if((e.d[t]&1)==0&&(s=1),a.e==0&&a.d[0]==1&&a.d.length==1)return a.s=s,a}return n=q(+a,u),t=n==0||!isFinite(n)?H(u*(Math.log("0."+G(a.d))/Math.LN10+a.e+1)):new c(n+"").e,t>c.maxE+1||t<c.minE-1?new c(t>0?s/0:0):(k=!1,c.rounding=a.s=1,n=Math.min(12,(t+"").length),i=ft(e.times(ue(a,r+n)),r),i.d&&(i=L(i,r+5,1),Se(i.d,r,o)&&(t=r+10,i=L(ft(e.times(ue(a,t+n)),t),t+5,1),+G(i.d).slice(r+1,r+15)+1==1e14&&(i=L(i,r+1,0)))),i.s=s,k=!0,c.rounding=o,L(i,r,o))};d.toPrecision=function(e,t){var n,r=this,i=r.constructor;return e===void 0?n=$(r,r.e<=i.toExpNeg||r.e>=i.toExpPos):(J(e,1,le),t===void 0?t=i.rounding:J(t,0,8),r=L(new i(r),e,t),n=$(r,e<=r.e||r.e<=i.toExpNeg,e)),r.isNeg()&&!r.isZero()?"-"+n:n};d.toSignificantDigits=d.toSD=function(e,t){var n=this,r=n.constructor;return e===void 0?(e=r.precision,t=r.rounding):(J(e,1,le),t===void 0?t=r.rounding:J(t,0,8)),L(new r(n),e,t)};d.toString=function(){var e=this,t=e.constructor,n=$(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n};d.truncated=d.trunc=function(){return L(new this.constructor(this),this.e+1,1)};d.valueOf=d.toJSON=function(){var e=this,t=e.constructor,n=$(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function G(e){var t,n,r,i=e.length-1,o="",s=e[0];if(i>0){for(o+=s,t=1;t<i;t++)r=e[t]+"",n=C-r.length,n&&(o+=ae(n)),o+=r;s=e[t],r=s+"",n=C-r.length,n&&(o+=ae(n))}else if(s===0)return"0";for(;s%10===0;)s/=10;return o+s}function J(e,t,n){if(e!==~~e||e<t||e>n)throw Error(ce+e)}function Se(e,t,n,r){var i,o,s,a;for(o=e[0];o>=10;o/=10)--t;return--t<0?(t+=C,i=0):(i=Math.ceil((t+1)/C),t%=C),o=q(10,C-t),a=e[i]%o|0,r==null?t<3?(t==0?a=a/100|0:t==1&&(a=a/10|0),s=n<4&&a==99999||n>3&&a==49999||a==5e4||a==0):s=(n<4&&a+1==o||n>3&&a+1==o/2)&&(e[i+1]/o/100|0)==q(10,t-2)-1||(a==o/2||a==0)&&(e[i+1]/o/100|0)==0:t<4?(t==0?a=a/1e3|0:t==1?a=a/100|0:t==2&&(a=a/10|0),s=(r||n<4)&&a==9999||!r&&n>3&&a==4999):s=((r||n<4)&&a+1==o||!r&&n>3&&a+1==o/2)&&(e[i+1]/o/1e3|0)==q(10,t-3)-1,s}function We(e,t,n){for(var r,i=[0],o,s=0,a=e.length;s<a;){for(o=i.length;o--;)i[o]*=t;for(i[0]+=ut.indexOf(e.charAt(s++)),r=0;r<i.length;r++)i[r]>n-1&&(i[r+1]===void 0&&(i[r+1]=0),i[r+1]+=i[r]/n|0,i[r]%=n)}return i.reverse()}function Dn(e,t){var n,r,i;if(t.isZero())return t;r=t.d.length,r<32?(n=Math.ceil(r/3),i=(1/ze(4,n)).toString()):(n=16,i="2.3283064365386962890625e-10"),e.precision+=n,t=we(e,1,t.times(i),new e(1));for(var o=n;o--;){var s=t.times(t);t=s.times(s).minus(s).times(8).plus(1)}return e.precision-=n,t}var V=function(){function e(r,i,o){var s,a=0,c=r.length;for(r=r.slice();c--;)s=r[c]*i+a,r[c]=s%o|0,a=s/o|0;return a&&r.unshift(a),r}function t(r,i,o,s){var a,c;if(o!=s)c=o>s?1:-1;else for(a=c=0;a<o;a++)if(r[a]!=i[a]){c=r[a]>i[a]?1:-1;break}return c}function n(r,i,o,s){for(var a=0;o--;)r[o]-=a,a=r[o]<i[o]?1:0,r[o]=a*s+r[o]-i[o];for(;!r[0]&&r.length>1;)r.shift()}return function(r,i,o,s,a,c){var u,l,f,m,p,h,g,b,P,A,x,y,T,S,N,w,E,O,F,M,v=r.constructor,U=r.s==i.s?1:-1,_=r.d,I=i.d;if(!_||!_[0]||!I||!I[0])return new v(!r.s||!i.s||(_?I&&_[0]==I[0]:!I)?NaN:_&&_[0]==0||!I?U*0:U/0);for(c?(p=1,l=r.e-i.e):(c=Y,p=C,l=H(r.e/p)-H(i.e/p)),F=I.length,E=_.length,P=new v(U),A=P.d=[],f=0;I[f]==(_[f]||0);f++);if(I[f]>(_[f]||0)&&l--,o==null?(S=o=v.precision,s=v.rounding):a?S=o+(r.e-i.e)+1:S=o,S<0)A.push(1),h=!0;else{if(S=S/p+2|0,f=0,F==1){for(m=0,I=I[0],S++;(f<E||m)&&S--;f++)N=m*c+(_[f]||0),A[f]=N/I|0,m=N%I|0;h=m||f<E}else{for(m=c/(I[0]+1)|0,m>1&&(I=e(I,m,c),_=e(_,m,c),F=I.length,E=_.length),w=F,x=_.slice(0,F),y=x.length;y<F;)x[y++]=0;M=I.slice(),M.unshift(0),O=I[0],I[1]>=c/2&&++O;do m=0,u=t(I,x,F,y),u<0?(T=x[0],F!=y&&(T=T*c+(x[1]||0)),m=T/O|0,m>1?(m>=c&&(m=c-1),g=e(I,m,c),b=g.length,y=x.length,u=t(g,x,b,y),u==1&&(m--,n(g,F<b?M:I,b,c))):(m==0&&(u=m=1),g=I.slice()),b=g.length,b<y&&g.unshift(0),n(x,g,y,c),u==-1&&(y=x.length,u=t(I,x,F,y),u<1&&(m++,n(x,F<y?M:I,y,c))),y=x.length):u===0&&(m++,x=[0]),A[f++]=m,u&&x[0]?x[y++]=_[w]||0:(x=[_[w]],y=1);while((w++<E||x[0]!==void 0)&&S--);h=x[0]!==void 0}A[0]||A.shift()}if(p==1)P.e=l,Ft=h;else{for(f=1,m=A[0];m>=10;m/=10)f++;P.e=f+l*p-1,L(P,a?o+P.e+1:o,s,h)}return P}}();function L(e,t,n,r){var i,o,s,a,c,u,l,f,m,p=e.constructor;e:if(t!=null){if(f=e.d,!f)return e;for(i=1,a=f[0];a>=10;a/=10)i++;if(o=t-i,o<0)o+=C,s=t,l=f[m=0],c=l/q(10,i-s-1)%10|0;else if(m=Math.ceil((o+1)/C),a=f.length,m>=a)if(r){for(;a++<=m;)f.push(0);l=c=0,i=1,o%=C,s=o-C+1}else break e;else{for(l=a=f[m],i=1;a>=10;a/=10)i++;o%=C,s=o-C+i,c=s<0?0:l/q(10,i-s-1)%10|0}if(r=r||t<0||f[m+1]!==void 0||(s<0?l:l%q(10,i-s-1)),u=n<4?(c||r)&&(n==0||n==(e.s<0?3:2)):c>5||c==5&&(n==4||r||n==6&&(o>0?s>0?l/q(10,i-s):0:f[m-1])%10&1||n==(e.s<0?8:7)),t<1||!f[0])return f.length=0,u?(t-=e.e+1,f[0]=q(10,(C-t%C)%C),e.e=-t||0):f[0]=e.e=0,e;if(o==0?(f.length=m,a=1,m--):(f.length=m+1,a=q(10,C-o),f[m]=s>0?(l/q(10,i-s)%q(10,s)|0)*a:0),u)for(;;)if(m==0){for(o=1,s=f[0];s>=10;s/=10)o++;for(s=f[0]+=a,a=1;s>=10;s/=10)a++;o!=a&&(e.e++,f[0]==Y&&(f[0]=1));break}else{if(f[m]+=a,f[m]!=Y)break;f[m--]=0,a=1}for(o=f.length;f[--o]===0;)f.pop()}return k&&(e.e>p.maxE?(e.d=null,e.e=NaN):e.e<p.minE&&(e.e=0,e.d=[0])),e}function $(e,t,n){if(!e.isFinite())return jt(e);var r,i=e.e,o=G(e.d),s=o.length;return t?(n&&(r=n-s)>0?o=o.charAt(0)+"."+o.slice(1)+ae(r):s>1&&(o=o.charAt(0)+"."+o.slice(1)),o=o+(e.e<0?"e":"e+")+e.e):i<0?(o="0."+ae(-i-1)+o,n&&(r=n-s)>0&&(o+=ae(r))):i>=s?(o+=ae(i+1-s),n&&(r=n-i-1)>0&&(o=o+"."+ae(r))):((r=i+1)<s&&(o=o.slice(0,r)+"."+o.slice(r)),n&&(r=n-s)>0&&(i+1===s&&(o+="."),o+=ae(r))),o}function je(e,t){var n=e[0];for(t*=C;n>=10;n/=10)t++;return t}function Ge(e,t,n){if(t>Mn)throw k=!0,n&&(e.precision=n),Error(Vt);return L(new e(Ue),t,1,!0)}function X(e,t,n){if(t>lt)throw Error(Vt);return L(new e(qe),t,n,!0)}function qt(e){var t=e.length-1,n=t*C+1;if(t=e[t],t){for(;t%10==0;t/=10)n--;for(t=e[0];t>=10;t/=10)n++}return n}function ae(e){for(var t="";e--;)t+="0";return t}function Gt(e,t,n,r){var i,o=new e(1),s=Math.ceil(r/C+4);for(k=!1;;){if(n%2&&(o=o.times(t),vt(o.d,s)&&(i=!0)),n=H(n/2),n===0){n=o.d.length-1,i&&o.d[n]===0&&++o.d[n];break}t=t.times(t),vt(t.d,s)}return k=!0,o}function Ot(e){return e.d[e.d.length-1]&1}function Ht(e,t,n){for(var r,i=new e(t[0]),o=0;++o<t.length;)if(r=new e(t[o]),r.s)i[n](r)&&(i=r);else{i=r;break}return i}function ft(e,t){var n,r,i,o,s,a,c,u=0,l=0,f=0,m=e.constructor,p=m.rounding,h=m.precision;if(!e.d||!e.d[0]||e.e>17)return new m(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:0/0);for(t==null?(k=!1,c=h):c=t,a=new m(.03125);e.e>-2;)e=e.times(a),f+=5;for(r=Math.log(q(2,f))/Math.LN10*2+5|0,c+=r,n=o=s=new m(1),m.precision=c;;){if(o=L(o.times(e),c,1),n=n.times(++l),a=s.plus(V(o,n,c,1)),G(a.d).slice(0,c)===G(s.d).slice(0,c)){for(i=f;i--;)s=L(s.times(s),c,1);if(t==null)if(u<3&&Se(s.d,c-r,p,u))m.precision=c+=10,n=o=a=new m(1),l=0,u++;else return L(s,m.precision=h,p,k=!0);else return m.precision=h,s}s=a}}function ue(e,t){var n,r,i,o,s,a,c,u,l,f,m,p=1,h=10,g=e,b=g.d,P=g.constructor,A=P.rounding,x=P.precision;if(g.s<0||!b||!b[0]||!g.e&&b[0]==1&&b.length==1)return new P(b&&!b[0]?-1/0:g.s!=1?NaN:b?0:g);if(t==null?(k=!1,l=x):l=t,P.precision=l+=h,n=G(b),r=n.charAt(0),Math.abs(o=g.e)<15e14){for(;r<7&&r!=1||r==1&&n.charAt(1)>3;)g=g.times(e),n=G(g.d),r=n.charAt(0),p++;o=g.e,r>1?(g=new P("0."+n),o++):g=new P(r+"."+n.slice(1))}else return u=Ge(P,l+2,x).times(o+""),g=ue(new P(r+"."+n.slice(1)),l-h).plus(u),P.precision=x,t==null?L(g,x,A,k=!0):g;for(f=g,c=s=g=V(g.minus(1),g.plus(1),l,1),m=L(g.times(g),l,1),i=3;;){if(s=L(s.times(m),l,1),u=c.plus(V(s,new P(i),l,1)),G(u.d).slice(0,l)===G(c.d).slice(0,l))if(c=c.times(2),o!==0&&(c=c.plus(Ge(P,l+2,x).times(o+""))),c=V(c,new P(p),l,1),t==null)if(Se(c.d,l-h,A,a))P.precision=l+=h,u=s=g=V(f.minus(1),f.plus(1),l,1),m=L(g.times(g),l,1),i=a=1;else return L(c,P.precision=x,A,k=!0);else return P.precision=x,c;c=u,i+=2}}function jt(e){return String(e.s*e.s/0)}function mt(e,t){var n,r,i;for((n=t.indexOf("."))>-1&&(t=t.replace(".","")),(r=t.search(/e/i))>0?(n<0&&(n=r),n+=+t.slice(r+1),t=t.substring(0,r)):n<0&&(n=t.length),r=0;t.charCodeAt(r)===48;r++);for(i=t.length;t.charCodeAt(i-1)===48;--i);if(t=t.slice(r,i),t){if(i-=r,e.e=n=n-r-1,e.d=[],r=(n+1)%C,n<0&&(r+=C),r<i){for(r&&e.d.push(+t.slice(0,r)),i-=C;r<i;)e.d.push(+t.slice(r,r+=C));t=t.slice(r),r=C-t.length}else r-=i;for(;r--;)t+="0";e.d.push(+t),k&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function Rn(e,t){var n,r,i,o,s,a,c,u,l;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),Ut.test(t))return mt(e,t)}else if(t==="Infinity"||t==="NaN")return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(Nn.test(t))n=16,t=t.toLowerCase();else if(Bn.test(t))n=2;else if(In.test(t))n=8;else throw Error(ce+t);for(o=t.search(/p/i),o>0?(c=+t.slice(o+1),t=t.substring(2,o)):t=t.slice(2),o=t.indexOf("."),s=o>=0,r=e.constructor,s&&(t=t.replace(".",""),a=t.length,o=a-o,i=Gt(r,new r(n),o,o*2)),u=We(t,n,Y),l=u.length-1,o=l;u[o]===0;--o)u.pop();return o<0?new r(e.s*0):(e.e=je(u,l),e.d=u,k=!1,s&&(e=V(e,i,a*4)),c&&(e=e.times(Math.abs(c)<54?q(2,c):Ze.pow(2,c))),k=!0,e)}function On(e,t){var n,r=t.d.length;if(r<3)return t.isZero()?t:we(e,2,t,t);n=1.4*Math.sqrt(r),n=n>16?16:n|0,t=t.times(1/ze(5,n)),t=we(e,2,t,t);for(var i,o=new e(5),s=new e(16),a=new e(20);n--;)i=t.times(t),t=t.times(o.plus(i.times(s.times(i).minus(a))));return t}function we(e,t,n,r,i){var o,s,a,c,u=1,l=e.precision,f=Math.ceil(l/C);for(k=!1,c=n.times(n),a=new e(r);;){if(s=V(a.times(c),new e(t++*t++),l,1),a=i?r.plus(s):r.minus(s),r=V(s.times(c),new e(t++*t++),l,1),s=a.plus(r),s.d[f]!==void 0){for(o=f;s.d[o]===a.d[o]&&o--;);if(o==-1)break}o=a,a=r,r=s,s=o,u++}return k=!0,s.d.length=f+1,s}function ze(e,t){for(var n=e;--t;)n*=e;return n}function zt(e,t){var n,r=t.s<0,i=X(e,e.precision,1),o=i.times(.5);if(t=t.abs(),t.lte(o))return re=r?4:1,t;if(n=t.divToInt(i),n.isZero())re=r?3:2;else{if(t=t.minus(n.times(i)),t.lte(o))return re=Ot(n)?r?2:3:r?4:1,t;re=Ot(n)?r?1:4:r?3:2}return t.minus(i).abs()}function dt(e,t,n,r){var i,o,s,a,c,u,l,f,m,p=e.constructor,h=n!==void 0;if(h?(J(n,1,le),r===void 0?r=p.rounding:J(r,0,8)):(n=p.precision,r=p.rounding),!e.isFinite())l=jt(e);else{for(l=$(e),s=l.indexOf("."),h?(i=2,t==16?n=n*4-3:t==8&&(n=n*3-2)):i=t,s>=0&&(l=l.replace(".",""),m=new p(1),m.e=l.length-s,m.d=We($(m),10,i),m.e=m.d.length),f=We(l,10,i),o=c=f.length;f[--c]==0;)f.pop();if(!f[0])l=h?"0p+0":"0";else{if(s<0?o--:(e=new p(e),e.d=f,e.e=o,e=V(e,m,n,r,0,i),f=e.d,o=e.e,u=Ft),s=f[n],a=i/2,u=u||f[n+1]!==void 0,u=r<4?(s!==void 0||u)&&(r===0||r===(e.s<0?3:2)):s>a||s===a&&(r===4||u||r===6&&f[n-1]&1||r===(e.s<0?8:7)),f.length=n,u)for(;++f[--n]>i-1;)f[n]=0,n||(++o,f.unshift(1));for(c=f.length;!f[c-1];--c);for(s=0,l="";s<c;s++)l+=ut.charAt(f[s]);if(h){if(c>1)if(t==16||t==8){for(s=t==16?4:3,--c;c%s;c++)l+="0";for(f=We(l,i,t),c=f.length;!f[c-1];--c);for(s=1,l="1.";s<c;s++)l+=ut.charAt(f[s])}else l=l.charAt(0)+"."+l.slice(1);l=l+(o<0?"p":"p+")+o}else if(o<0){for(;++o;)l="0"+l;l="0."+l}else if(++o>c)for(o-=c;o--;)l+="0";else o<c&&(l=l.slice(0,o)+"."+l.slice(o))}l=(t==16?"0x":t==2?"0b":t==8?"0o":"")+l}return e.s<0?"-"+l:l}function vt(e,t){if(e.length>t)return e.length=t,!0}function vn(e){return new this(e).abs()}function _n(e){return new this(e).acos()}function Fn(e){return new this(e).acosh()}function Vn(e,t){return new this(e).plus(t)}function Kn(e){return new this(e).asin()}function Wn(e){return new this(e).asinh()}function Un(e){return new this(e).atan()}function qn(e){return new this(e).atanh()}function Gn(e,t){e=new this(e),t=new this(t);var n,r=this.precision,i=this.rounding,o=r+4;return!e.s||!t.s?n=new this(NaN):!e.d&&!t.d?(n=X(this,o,1).times(t.s>0?.25:.75),n.s=e.s):!t.d||e.isZero()?(n=t.s<0?X(this,r,i):new this(0),n.s=e.s):!e.d||t.isZero()?(n=X(this,o,1).times(.5),n.s=e.s):t.s<0?(this.precision=o,this.rounding=1,n=this.atan(V(e,t,o,1)),t=X(this,o,1),this.precision=r,this.rounding=i,n=e.s<0?n.minus(t):n.plus(t)):n=this.atan(V(e,t,o,1)),n}function Hn(e){return new this(e).cbrt()}function jn(e){return L(e=new this(e),e.e+1,2)}function zn(e,t,n){return new this(e).clamp(t,n)}function Zn(e){if(!e||typeof e!="object")throw Error(He+"Object expected");var t,n,r,i=e.defaults===!0,o=["precision",1,le,"rounding",0,8,"toExpNeg",-ye,0,"toExpPos",0,ye,"maxE",0,ye,"minE",-ye,0,"modulo",0,9];for(t=0;t<o.length;t+=3)if(n=o[t],i&&(this[n]=ct[n]),(r=e[n])!==void 0)if(H(r)===r&&r>=o[t+1]&&r<=o[t+2])this[n]=r;else throw Error(ce+n+": "+r);if(n="crypto",i&&(this[n]=ct[n]),(r=e[n])!==void 0)if(r===!0||r===!1||r===0||r===1)if(r)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[n]=!0;else throw Error(Kt);else this[n]=!1;else throw Error(ce+n+": "+r);return this}function Jn(e){return new this(e).cos()}function Qn(e){return new this(e).cosh()}function Zt(e){var t,n,r;function i(o){var s,a,c,u=this;if(!(u instanceof i))return new i(o);if(u.constructor=i,_t(o)){u.s=o.s,k?!o.d||o.e>i.maxE?(u.e=NaN,u.d=null):o.e<i.minE?(u.e=0,u.d=[0]):(u.e=o.e,u.d=o.d.slice()):(u.e=o.e,u.d=o.d?o.d.slice():o.d);return}if(c=typeof o,c==="number"){if(o===0){u.s=1/o<0?-1:1,u.e=0,u.d=[0];return}if(o<0?(o=-o,u.s=-1):u.s=1,o===~~o&&o<1e7){for(s=0,a=o;a>=10;a/=10)s++;k?s>i.maxE?(u.e=NaN,u.d=null):s<i.minE?(u.e=0,u.d=[0]):(u.e=s,u.d=[o]):(u.e=s,u.d=[o]);return}else if(o*0!==0){o||(u.s=NaN),u.e=NaN,u.d=null;return}return mt(u,o.toString())}else if(c!=="string")throw Error(ce+o);return(a=o.charCodeAt(0))===45?(o=o.slice(1),u.s=-1):(a===43&&(o=o.slice(1)),u.s=1),Ut.test(o)?mt(u,o):Rn(u,o)}if(i.prototype=d,i.ROUND_UP=0,i.ROUND_DOWN=1,i.ROUND_CEIL=2,i.ROUND_FLOOR=3,i.ROUND_HALF_UP=4,i.ROUND_HALF_DOWN=5,i.ROUND_HALF_EVEN=6,i.ROUND_HALF_CEIL=7,i.ROUND_HALF_FLOOR=8,i.EUCLID=9,i.config=i.set=Zn,i.clone=Zt,i.isDecimal=_t,i.abs=vn,i.acos=_n,i.acosh=Fn,i.add=Vn,i.asin=Kn,i.asinh=Wn,i.atan=Un,i.atanh=qn,i.atan2=Gn,i.cbrt=Hn,i.ceil=jn,i.clamp=zn,i.cos=Jn,i.cosh=Qn,i.div=Xn,i.exp=Yn,i.floor=$n,i.hypot=er,i.ln=tr,i.log=nr,i.log10=ir,i.log2=rr,i.max=or,i.min=sr,i.mod=ar,i.mul=ur,i.pow=cr,i.random=lr,i.round=fr,i.sign=mr,i.sin=dr,i.sinh=pr,i.sqrt=gr,i.sub=hr,i.sum=br,i.tan=yr,i.tanh=wr,i.trunc=Tr,e===void 0&&(e={}),e&&e.defaults!==!0)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<r.length;)e.hasOwnProperty(n=r[t++])||(e[n]=this[n]);return i.config(e),i}function Xn(e,t){return new this(e).div(t)}function Yn(e){return new this(e).exp()}function $n(e){return L(e=new this(e),e.e+1,3)}function er(){var e,t,n=new this(0);for(k=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)n.d&&(n=n.plus(t.times(t)));else{if(t.s)return k=!0,new this(1/0);n=t}return k=!0,n.sqrt()}function _t(e){return e instanceof Ze||e&&e.toStringTag===Wt||!1}function tr(e){return new this(e).ln()}function nr(e,t){return new this(e).log(t)}function rr(e){return new this(e).log(2)}function ir(e){return new this(e).log(10)}function or(){return Ht(this,arguments,"lt")}function sr(){return Ht(this,arguments,"gt")}function ar(e,t){return new this(e).mod(t)}function ur(e,t){return new this(e).mul(t)}function cr(e,t){return new this(e).pow(t)}function lr(e){var t,n,r,i,o=0,s=new this(1),a=[];if(e===void 0?e=this.precision:J(e,1,le),r=Math.ceil(e/C),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(r));o<r;)i=t[o],i>=429e7?t[o]=crypto.getRandomValues(new Uint32Array(1))[0]:a[o++]=i%1e7;else if(crypto.randomBytes){for(t=crypto.randomBytes(r*=4);o<r;)i=t[o]+(t[o+1]<<8)+(t[o+2]<<16)+((t[o+3]&127)<<24),i>=214e7?crypto.randomBytes(4).copy(t,o):(a.push(i%1e7),o+=4);o=r/4}else throw Error(Kt);else for(;o<r;)a[o++]=Math.random()*1e7|0;for(r=a[--o],e%=C,r&&e&&(i=q(10,C-e),a[o]=(r/i|0)*i);a[o]===0;o--)a.pop();if(o<0)n=0,a=[0];else{for(n=-1;a[0]===0;n-=C)a.shift();for(r=1,i=a[0];i>=10;i/=10)r++;r<C&&(n-=C-r)}return s.e=n,s.d=a,s}function fr(e){return L(e=new this(e),e.e+1,this.rounding)}function mr(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function dr(e){return new this(e).sin()}function pr(e){return new this(e).sinh()}function gr(e){return new this(e).sqrt()}function hr(e,t){return new this(e).sub(t)}function br(){var e=0,t=arguments,n=new this(t[e]);for(k=!1;n.s&&++e<t.length;)n=n.plus(t[e]);return k=!0,L(n,this.precision,this.rounding)}function yr(e){return new this(e).tan()}function wr(e){return new this(e).tanh()}function Tr(e){return L(e=new this(e),e.e+1,1)}d[Symbol.for("nodejs.util.inspect.custom")]=d.toString;d[Symbol.toStringTag]="Decimal";var Ze=d.constructor=Zt(ct);Ue=new Ze(Ue);qe=new Ze(qe);import Br from"big.js";import Fi from"bn.js";import Pr from"toformat";var xr=Pr,Le=xr;import Qe from"big.js";import Sr from"bn.js";import Lr from"decimal.js-light";import Ce from"bn.js";var Jt=9007199254740991;function ie(e){let t=Z("Raydium_parseBigNumberish");if(e instanceof Ce)return e;if(typeof e=="string"){if(e.match(/^-?[0-9]+$/))return new Ce(e);t.logWithError(`invalid BigNumberish string: ${e}`)}return typeof e=="number"?(e%1&&t.logWithError(`BigNumberish number underflow: ${e}`),(e>=Jt||e<=-Jt)&&t.logWithError(`BigNumberish number overflow: ${e}`),new Ce(String(e))):typeof e=="bigint"?new Ce(e.toString()):(t.error(`invalid BigNumberish value: ${e}`),new Ce(0))}var Je=Z("module/fraction"),pt=Le(Qe),ke=Le(Lr),Cr={[0]:ke.ROUND_DOWN,[1]:ke.ROUND_HALF_UP,[2]:ke.ROUND_UP},kr={[0]:Qe.roundDown,[1]:Qe.roundHalfUp,[2]:Qe.roundUp},K=class{constructor(t,n=new Sr(1)){this.numerator=ie(t),this.denominator=ie(n)}get quotient(){return this.numerator.div(this.denominator)}invert(){return new K(this.denominator,this.numerator)}add(t){let n=t instanceof K?t:new K(ie(t));return this.denominator.eq(n.denominator)?new K(this.numerator.add(n.numerator),this.denominator):new K(this.numerator.mul(n.denominator).add(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}sub(t){let n=t instanceof K?t:new K(ie(t));return this.denominator.eq(n.denominator)?new K(this.numerator.sub(n.numerator),this.denominator):new K(this.numerator.mul(n.denominator).sub(n.numerator.mul(this.denominator)),this.denominator.mul(n.denominator))}mul(t){let n=t instanceof K?t:new K(ie(t));return new K(this.numerator.mul(n.numerator),this.denominator.mul(n.denominator))}div(t){let n=t instanceof K?t:new K(ie(t));return new K(this.numerator.mul(n.denominator),this.denominator.mul(n.numerator))}toSignificant(t,n={groupSeparator:""},r=1){Number.isInteger(t)||Je.logWithError(`${t} is not an integer.`),t<=0&&Je.logWithError(`${t} is not positive.`),ke.set({precision:t+1,rounding:Cr[r]});let i=new ke(this.numerator.toString()).div(this.denominator.toString()).toSignificantDigits(t);return i.toFormat(i.decimalPlaces(),n)}toFixed(t,n={groupSeparator:""},r=1){return Number.isInteger(t)||Je.logWithError(`${t} is not an integer.`),t<0&&Je.logWithError(`${t} is negative.`),pt.DP=t,pt.RM=kr[r]||1,new pt(this.numerator.toString()).div(this.denominator.toString()).toFormat(t,n)}isZero(){return this.numerator.isZero()}};var zi=Z("Raydium_amount"),Zi=Le(Br);import{PublicKey as Ir}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Qt}from"@solana/spl-token";var Xt={chainId:101,address:Ir.default.toBase58(),programId:Qt.toBase58(),decimals:9,symbol:"SOL",name:"solana",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}},de={chainId:101,address:"So11111111111111111111111111111111111111112",programId:Qt.toBase58(),decimals:9,symbol:"WSOL",name:"Wrapped SOL",logoURI:"https://img-v1.raydium.io/icon/So11111111111111111111111111111111111111112.png",tags:[],priority:2,type:"raydium",extensions:{coingeckoId:"solana"}};import{PublicKey as ht}from"@solana/web3.js";import{PublicKey as W,SystemProgram as Yt,SYSVAR_RENT_PUBKEY as Er}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Mr}from"@solana/spl-token";function gt({pubkey:e,isSigner:t=!1,isWritable:n=!0}){return{pubkey:e,isWritable:n,isSigner:t}}var no=[gt({pubkey:Mr,isWritable:!1}),gt({pubkey:Yt.programId,isWritable:!1}),gt({pubkey:Er,isWritable:!1})];function $t({publicKey:e,transformSol:t}){let n=en(e.toString());if(n instanceof W)return t&&n.equals(Be)?at:n;if(t&&n.toString()===Be.toBase58())return at;if(typeof n=="string"){if(n===W.default.toBase58())return W.default;try{return new W(n)}catch{throw new Error("invalid public key")}}throw new Error("invalid public key")}function en(e){try{return new W(e)}catch{return e}}var ro=new W("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),io=new W("MemoSq4gqABAXKb96qnH8TysNcWxMyWCqXgDLGmfcHr"),oo=new W("SysvarRent111111111111111111111111111111111"),so=new W("SysvarC1ock11111111111111111111111111111111"),ao=new W("metaqbxxUerdq28cj1RbAWkYQm3ybzjb6a8bt518x1s"),uo=new W("Sysvar1nstructions1111111111111111111111111"),co=Yt.programId,lo=new W("4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R"),fo=new W("Ea5SjE2Y6yvCeW5dYTn7PYMuW5ikXkvbGdcmSnXeaLjS"),mo=new W("SRMuApVNdxXokk5GT7XD5cUUgXMBCoAz2LHeuAoKWRt"),po=new W("EPjFWdd5AufqSSqeM2qN1xzybapC8G4wEGGkZwyTDt1v"),go=new W("Es9vMFrzaCERmJfrF4H2FYD4KCoNkY11McCe8BenwNYB"),ho=new W("mSoLzYCxHdYgdzU16g5QSh3i5K3z3KZK7ytfqcJm7So"),bo=new W("7dHbWXmci3dT8UFYWYZweBLXgycu7Y3iL6trKn1Y7ARj"),yo=new W("USDH1SM1ojwWUga67PGrgFWUHibbjqMvuMaDkRJTgkX"),wo=new W("NRVwhjBQiUPYtfDT5zRBVJajzFQHaBUNtC7SNVvqRFa"),To=new W("ANAxByE6G2WjFp7A4NqtWYXb3mgruyzZYg3spfxe6Lbo"),Po=new W("7vfCXTUXx5WJV5JADk17DUJ4ksgau7utNKj4b963voxs"),at=new W("So11111111111111111111111111111111111111112"),Be=W.default;var bt=class{constructor({mint:t,decimals:n,symbol:r,name:i,skipMint:o=!1,isToken2022:s=!1}){if(t===Be.toBase58()||t instanceof ht&&Be.equals(t)){this.decimals=de.decimals,this.symbol=de.symbol,this.name=de.name,this.mint=new ht(de.address),this.isToken2022=!1;return}this.decimals=n,this.symbol=r||t.toString().substring(0,6),this.name=i||t.toString().substring(0,6),this.mint=o?ht.default:$t({publicKey:t}),this.isToken2022=s}equals(t){return this===t?!0:this.mint.equals(t.mint)}},Q=bt;Q.WSOL=new bt(se(z({},de),{mint:de.address}));var yt=class{constructor({decimals:t,symbol:n="UNKNOWN",name:r="UNKNOWN"}){this.decimals=t,this.symbol=n,this.name=r}equals(t){return this===t}},Xe=yt;Xe.SOL=new yt(Xt);import Dr from"bn.js";var Do=new K(new Dr(100));var Vo=Z("Raydium_price");import{PublicKey as ns}from"@solana/web3.js";import is from"bn.js";var Rr=new oe(0),As=new oe(1),Ss=new oe(2),Ls=new oe(3),Cs=new oe(5),Nr=new oe(10),ks=new oe(100),Bs=new oe(1e3),Ns=new oe(1e4);function st(e,t=1,n=[]){let r=[...e];if(t<=0)return n;for(;r.length;)n.push(r.splice(0,t));return n}import{PublicKey as js}from"@solana/web3.js";import{TOKEN_PROGRAM_ID as Zs}from"@solana/spl-token";import{ComputeBudgetProgram as on,Keypair as an,PublicKey as Or,Transaction as un,TransactionMessage as vr,VersionedTransaction as cn}from"@solana/web3.js";var Ne={CreateAccount:"CreateAccount",InitAccount:"InitAccount",CreateATA:"CreateATA",CloseAccount:"CloseAccount",TransferAmount:"TransferAmount",InitMint:"InitMint",MintTo:"MintTo",InitMarket:"InitMarket",Util1216OwnerClaim:"Util1216OwnerClaim",SetComputeUnitPrice:"SetComputeUnitPrice",SetComputeUnitLimit:"SetComputeUnitLimit",ClmmCreatePool:"ClmmCreatePool",ClmmOpenPosition:"ClmmOpenPosition",ClmmIncreasePosition:"ClmmIncreasePosition",ClmmDecreasePosition:"ClmmDecreasePosition",ClmmClosePosition:"ClmmClosePosition",ClmmSwapBaseIn:"ClmmSwapBaseIn",ClmmSwapBaseOut:"ClmmSwapBaseOut",ClmmInitReward:"ClmmInitReward",ClmmSetReward:"ClmmSetReward",ClmmCollectReward:"ClmmCollectReward",ClmmLockPosition:"ClmmLockPosition",ClmmHarvestLockPosition:"ClmmHarvestLockPosition",AmmV4Swap:"AmmV4Swap",AmmV4AddLiquidity:"AmmV4AddLiquidity",AmmV4RemoveLiquidity:"AmmV4RemoveLiquidity",AmmV4SimulatePoolInfo:"AmmV4SimulatePoolInfo",AmmV4SwapBaseIn:"AmmV4SwapBaseIn",AmmV4SwapBaseOut:"AmmV4SwapBaseOut",AmmV4CreatePool:"AmmV4CreatePool",AmmV4InitPool:"AmmV4InitPool",AmmV5AddLiquidity:"AmmV5AddLiquidity",AmmV5RemoveLiquidity:"AmmV5RemoveLiquidity",AmmV5SimulatePoolInfo:"AmmV5SimulatePoolInfo",AmmV5SwapBaseIn:"AmmV5SwapBaseIn",AmmV5SwapBaseOut:"AmmV5SwapBaseOut",RouteSwap:"RouteSwap",RouteSwap1:"RouteSwap1",RouteSwap2:"RouteSwap2",FarmV3Deposit:"FarmV3Deposit",FarmV3Withdraw:"FarmV3Withdraw",FarmV3CreateLedger:"FarmV3CreateLedger",FarmV4Withdraw:"FarmV4Withdraw",FarmV5Deposit:"FarmV5Deposit",FarmV5Withdraw:"FarmV5Withdraw",FarmV5CreateLedger:"FarmV5CreateLedger",FarmV6Deposit:"FarmV6Deposit",FarmV6Withdraw:"FarmV6Withdraw",FarmV6Create:"FarmV6Create",FarmV6Restart:"FarmV6Restart",FarmV6CreatorAddReward:"FarmV6CreatorAddReward",FarmV6CreatorWithdraw:"FarmV6CreatorWithdraw",CpmmCreatePool:"CpmmCreatePool",CpmmAddLiquidity:"CpmmAddLiquidity",CpmmWithdrawLiquidity:"CpmmWithdrawLiquidity",CpmmSwapBaseIn:"CpmmSwapBaseIn",CpmmSwapBaseOut:"CpmmSwapBaseOut",CpmmLockLp:"CpmmLockLp",CpmmCollectLockFee:"CpmmCollectLockFee",TransferTip:"TransferTip"};import{TOKEN_PROGRAM_ID as _r}from"@solana/spl-token";var sn=Z("Raydium_txUtil"),ln=1644;function Ye(e){let t=[],n=[];return e.microLamports&&(t.push(on.setComputeUnitPrice({microLamports:e.microLamports})),n.push(Ne.SetComputeUnitPrice)),e.units&&(t.push(on.setComputeUnitLimit({units:e.units})),n.push(Ne.SetComputeUnitLimit)),{instructions:t,instructionTypes:n}}async function Te(e,t){var r,i;let n=t!=null?t:"confirmed";return(i=await((r=e.getLatestBlockhash)==null?void 0:r.call(e,{commitment:n})))==null?void 0:i.blockhash}async function wt(e,t){return e.getSignatureStatuses([t]),new Promise((n,r)=>{let i=setTimeout(r,6e4);e.onSignature(t,o=>{if(clearTimeout(i),!o.err){n("");return}r(Object.assign(o.err,{txId:t}))},"confirmed")})}function Tt(e,t){e.length<1&&sn.logWithError(`no instructions provided: ${e.toString()}`),t.length<1&&sn.logWithError(`no signers provided:, ${t.toString()}`);let n=new un;n.recentBlockhash="11111111111111111111111111111111",n.feePayer=t[0],n.add(...e);try{return Buffer.from(n.serialize({verifySignatures:!1})).toString("base64").length<ln}catch{return!1}}function $e(e,t){let[n,r]=Or.findProgramAddressSync(e,t);return{publicKey:n,nonce:r}}function Ie({instructions:e,payer:t,signers:n}){return Tt(e,[t,...n])}function Ee({instructions:e,payer:t,lookupTableAddressAccount:n,recentBlockhash:r=an.generate().publicKey.toString()}){let o=new vr({payerKey:t,recentBlockhash:r,instructions:e}).compileToV0Message(Object.values(n!=null?n:{}));try{return Buffer.from(new cn(o).serialize()).toString("base64").length<ln}catch{return!1}}var Fr=e=>Buffer.isBuffer(e)?e:e instanceof Uint8Array?Buffer.from(e.buffer,e.byteOffset,e.byteLength):Buffer.from(e),Vr=e=>{let t=e.serialize({requireAllSignatures:!1,verifySignatures:!1});e instanceof cn&&(t=Fr(t));try{return t instanceof Buffer?t.toString("base64"):Buffer.from(t).toString("base64")}catch{return t.toString("base64")}};function pe(e){let t=[];return e.forEach(n=>{n instanceof un&&(n.recentBlockhash||(n.recentBlockhash=_r.toBase58()),n.feePayer||(n.feePayer=an.generate().publicKey)),t.push(Vr(n))}),console.log("simulate tx string:",t),t}import{PublicKey as B}from"@solana/web3.js";var Ys=new B("EhhTKczWMGQt46ynNeRX1WfeagwwJd7ufHvCDjRxjo5Q"),$s=new B("CBuCnLe26faBpcBP2fktp4rp8abpcAnTWft6ZrP5Q4T"),ea=new B("9KEPoZmtHUrBbhWN1v1KWLMkkvwY6WLtAVUCPRtRjP4z"),ta=new B("FarmqiPv5eAj3j1GMdMCMUGXqPUvmquZtMy86QH6rzhG"),na=new B("CLaimxFqjHzgTJtAGHU47NPhg6qrc5sCnpC4tBLyABQS"),ra=new B("srmqPvymJeFKQ4zGQed1GFppgkRHL9kaELCbyksJtPX"),ia=new B("9xQeWvG816bUx9EPjHmaT23yvVM2ZWbrrpZb9PusVFin"),oa=new B("675kPX9MHTjS2zt1qfr1NYHuzeLXfQM9H24wFSUt1Mp8"),sa=new B("5quBtoiQqxF9Jv6KYKctB59NT3gtJD2Y65kdnB1Uev3h"),aa=new B("CDSr3ssLcRB6XYPJwAfFt18MZvEZp4LjHcvzBVZ45duo"),ua=new B("CAMMCzo5YL8w4VFF8KVHrK22GGUsp5VTaW7grrKgrWqK"),ca=new B("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),la=new B("kN1kEznaF5Xbd8LYuqtEFcxzWSBk5Fv6ygX6SqEGJVy"),fa=new B("routeUGWgWzqBWFcrCfv8tritsqukccJPu3q5GPP3xS"),ma=new B("7YttLkHDoNj9wyDur5pM1ejNaAvT9X4eqaYcHQqtj2G5"),da=new B("6FJon3QE27qgPVggARueB22hLvoh22VzJpXv4rBEoSLF"),pa=new B("CC12se5To1CdEuw7fDS27B7Geo5jJyL7t5UK2B44NgiH"),ga=new B("9HzJyW1qZsEiSfMUf6L2jo3CcTKAyBmSyKdwQeYisHrC"),ha=new B("DropEU8AvevN3UrXWXTMuz3rqnMczQVNjq3kcSdW2SQi"),ba=new B("CPMMoo8L3F4NbTegBCKVNunggL7H1ZpdTHKxQB5qKP1C"),ya=new B("GpMZbSM2GgvTKHJirzeGfMFoaZ8UR2X7F4v8vHTvxFbL"),wa=new B("DNXgeM9EiiaAbaWvwjHj9fQQLAX5ZsfHyvmYUNRAdNC8"),Kr=new B("CPMDWBwJDtYax9qW7AyRuVC19Cc4L4Vcy4n2BHAbHkCW"),Wr=new B("7rQ1QFNosMkUCuh7Z7fPbTHvh73b68sQYdirycEzJVuw"),Ur=new B("G11FKBRaAkHAKuLCgLM6K6NUc9rTjPAznRCjZifrTQe2"),Ta=new B("LockrWmn6K5twhz3y9w1dQERbmgSaRkfnTeTKbpofwE"),qr=new B("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),Pa=new B("3f7GcQFG397GAaEnv51zR6tsTVihYRydnydDD1cXekxH"),Gr=new B("7AFUeLVRjBfzqK3tTGw8hN48KLQWSk6DTE8xprWdPqix"),xa=new B("LanMV9sAd7wArD4vJFi2qDdfnVhFxYSUg6eADduJ3uj"),Aa=new B("WLHv2UAZm6z4KyaaELi5pjdbJh6RESMva1Rnn8pJVVh"),Hr=new B("LanD8FpTBBvzZFXjTxsAoipkFsxPUCDB4qAqKxYDiNP"),jr=new B("HYNHiyKJ3gGVFvyxJAurK7qr7P2o5J9THmvCGMdULtpW");var Sa={AMM_V4:new B("HWy1jotHpo6UqeQxx49dpYYdQB8wj9Qk9MdxwjLvDHB8"),AMM_STABLE:new B("DDg4VmQaJV9ogWce7LpcjBA9bv22wRp5uaTPa5pGjijF"),CLMM_PROGRAM_ID:new B("devi51mZmdwUJGU9hjN27vEz64Gps7uUefqxg27EAtH"),CLMM_LOCK_PROGRAM_ID:new B("DLockwT7X7sxtLmGH9g5kmfcjaBtncdbUmi738m5bvQC"),CLMM_LOCK_AUTH_ID:new B("8qmHNvu2Kr2C7U8mJL4Vz1vTDxMhVuXKREwU7TNoaVEo"),FARM_PROGRAM_ID_V3:new B("85BFyr98MbCUU9MVTEgzx1nbhWACbJqLzho6zd6DZcWL"),FARM_PROGRAM_ID_V5:new B("EcLzTrNg9V7qhcdyXDe2qjtPkiGzDM2UbdRaeaadU5r2"),FARM_PROGRAM_ID_V6:new B("Farm2hJLcqPtPg8M4rR6DMrsRNc5TPm5Cs4bVQrMe2T7"),OPEN_BOOK_PROGRAM:new B("EoTcMgcDRTJVZDMZWBoU6rhYHZfkNTVEAfz3uUJRcYGj"),SERUM_PROGRAM_ID_V3:B.default,UTIL1216:B.default,Router:new B("BVChZ3XFEwTMUk1o9i3HAf91H6mFxSwa5X2wFAWhYPhU"),CREATE_CPMM_POOL_PROGRAM:Kr,CREATE_CPMM_POOL_AUTH:Wr,CREATE_CPMM_POOL_FEE_ACC:Ur,LOCK_CPMM_PROGRAM:qr,LOCK_CPMM_AUTH:Gr,LAUNCHPAD_PROGRAM:Hr,LAUNCHPAD_AUTH:jr,FEE_DESTINATION_ID:new B("3XMrhbv989VxAMi3DErLV9eJht1pHppW5LbKxe9fkEFR")};import ka from"bn.js";import{PublicKey as fn,AddressLookupTableAccount as et}from"@solana/web3.js";async function Pt({connection:e,address:t}){let n=await Ke(e,[...new Set(t.map(i=>i.toString()))].map(i=>new fn(i))),r={};for(let i=0;i<t.length;i++){let o=n[i],s=t[i];if(!o)continue;let a=new et({key:s,state:et.deserialize(o.data)});r[s.toString()]=a,tt[s.toString()]=a}return r}var tt={AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU:new et({key:new fn("AcL1Vo8oy1ULiavEcjSUcwfBSForXMudcZvDZy5nzJkU"),state:et.deserialize(Buffer.from("AQAAAP//////////I1rcEwAAAAAvAQYwun9CU6c5Ikm2pAj+D9IEnCOR45nK+SFTGSdpd6J6AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbd9uHXZaGT2cvhRs7reawctIXtX1s3kTqM9YV+/wCpBt324e51j94YQl285GzN2rYa/E2DuQ0n/r35KNihi/wFSlNQ+F3IgtYUpVZyeIopbd8eq6vQpgZ4iEky9O72oAVKU1qZKSEGTSTocWDaOHx8NbXdvJK7geQfqEBBBUSNBqfVFxksXFEhjMlMPUrxf1ja7gibof1E49vZigAAAAAGp9UXGMd0yShWY5hpHV62i164o5tLbVxzVVshAAAAAIyXJY9OJInxuz0QKRSODYMLWhOZ2v8QhASOe9jb6fhZC3BlsePRfEU4nVJ/awTDzVi4bHMaoP21SbbRvAP4KUbIScv+6Yw2LHF/6K0ZjUPibbSWXCirYPGuuVl7zT789IUPLW4CpHr4JNCatp3ELXDLKMv6JJ+37le50lbBJ2LvBkX2T9y7AHdNGviJAqQNtlDUDCnauQRWybsLji6nPM8Qkw5asQRvCdB3MbX6IEBwytOrpM32l4jQygKG9TKgR0vZScQ2AsM/IHeQ7RajUkyhuZdc8SGiqQz/7H34torNR/Wir3sl0ruUrVxJWEZfUg+QLNAxxODdBi53/OP7Ioil1cqeBM9dtZC3FLov4yyxWRM/wcGStyJX/QfTnLBAHqkqWotPKVlShCVQqpP9W5W1rOao65IMk5QuQ2kMIOxzDMKAy2vjGSxQODgBz0QwGA+eP4ZjIjrIAQaXENv31QfLlOdXSRCkaybRniDHF4C8YcwhcvsqrOVuTP4B2Na+9wLdtrB31uz2rtlFI5kahdsnp/d1SrASDInYCtTYtdoke4kX+hoKWcEWM4Tle8pTUkUVv4BxS6fje/EzKBE4Qu/YsA/yfEEFGcr8Z57VKDw8uQzpiru7g4lvjnfapW62W030syevD8k07SGoxUHiuT/ai7gAHWWhDsVmg/C63ajgpkH7Sn3GdutArDTfyqOkdqv4/IPC/EFFy7mGkfDd2C57N5a/4jC+BbmJy7wQaSEZr0CQU88lPtUxIVvzGjC95b8Ooss2TqmkrayGKofkPMGQn7Ux+9lfwBSNfxwH8NgbpqC/7LNlV4I7nCvsXf3p+ohQk9NrAJb2KAFpUqEIJ9ZBV7BYDzHF/ORKYlgtvPnXjudZQ6CEo5OzUDaNIomTCCsvhD16TxJjsbgne1kGnQPCFSoaxUbq2V1bPMFQ3VYP6wDZ9bKStCFKx9A3tNbwZFC5ZGAN83MFK7XoTy+OmmcFEr6rLOjfSuTfPvHJkSVxW6Qllwkl67XcBi5v00u2gQsbu+38sp+rd5pA/LvyWj4P94ZGZwc1tE2P88xekCLcAwZGb+UhFzL/7K26csOb57yM5bvF9xJrLEObOkAAAAAn+HWRkdcPKyFFMnVwEoD7vnD0jCKFIU1sImubYCxNTSVzsKpaQX+fzNxrLAI3L14JQnJx/D6Uk2LADIHGqnGELzjEbkBDAlaM77NkXMPfqXNLSveCkWI7UEgNs31WEWB6XHSYI/v5DklHOb4QTtDOR804PVbi3fjloZeLR2F8d4FuZmMMO7ck3Fnkn2zEMG5gOmqsygb6PjTitArVl52NhcSznTxVnguaIJxiZkAnurDmn3MWR0PC2GLghp2KJqHCc6QQ85odeIjFHKOlRlJyeSXVJmL8vb1UgOzsbJPVP8p6zM4M3C1Sd7uWIHP33G42AP2Zg8ucn/n6meQjjD266JgCWdxZD6PXs9CsnIeL7SSG0/6lGb9xfP0ZcWkCXB/3hjxHYVXjra/GPOeXGk0fLLKjCbk+mgs2w6d2oCwimBipTzuoZ30GiI8ij8VRzD5CzMWtu2m21eDBIfjGAEo4pQeNNonKcqzV/cleX8ySZLOHsz8PtBCrLqF+VkLm9hOzIT+6i/nIf6keR4GWKMOD4AvqfpjHoD4DuhBpz8P28+DxkGrDXXr/nr20x291VPvcTU/b+b+o2kC9G0kcXeTlLjU6a2TQXWlZ4gBUdBl1jgT7mObSTpLblNiXZsLkbmVXZwvFKXua5cUKlWed/w30skmEUraTuQqtqr5fHZPW9n57EmeTif6LjHL2YJFZkQU+TrJmFzqzmF4/b8OwrPQAprl8mX3q4LUIdAS/a+11B6DWD1Xk2++Sn94dLC4xjkO4Wtlw8c4XuzciVbepHOmnoWzVu/0y3KCrLCSfQxQ3br8DJCoVzhgtPsS2nZZjsBGIZgnU0QpMv+2MnRsnKwdp1VsrCX84j/qvaZn4WhKunippgTbN2EUs0tPTP55Qfgj+nKmjtWW5IYs72FrEwJKYoNfsmqaF4o5pf4v9zgPwVwY/5I4XJKUL2L25m9kAQcW/K+H1RTFEUoj8Z4ajpOmAB/dG0COmCphVMW2CCMvnxhcGiSgPnpDuWu6qiJ7NG7ye5kvHgefgqPLeicspNJ5EpL3XiRNLM2tmJLI1awAwOyd6iHv0dCkMYRKaa6rcaZeYwmKCkckm0kM2JNmnmmAaBQQ7mwmIM0IMxX4f5W6j9PqZWcJxF7r17T/lQBAmcjoupRiJifbnXCNUv9GhpRF19WcBdeKbivRJVlGop6I2RS6lGImJ9udcI1S/0aGlEXX1ZwF14puK9ElWUainojZFYVHLHD6dIP2ESjqBzg3ol1/wB7+/ylGwd9LS7wSZ2A630CJSVKwH47K9P4bB8PEQP8BwjMFa7xQHOqZFP1XqaQ==","base64"))})};import{PublicKey as ge,sendAndConfirmTransaction as xt,SystemProgram as mn,Transaction as Me,TransactionMessage as De,VersionedTransaction as Re}from"@solana/web3.js";import zr from"axios";import{LAMPORTS_PER_SOL as pn}from"@solana/web3.js";var Zr="http://sg-sender.helius-rpc.com/fast",ja=.001*pn,dn=["4ACfpUFoaSD9bfPdeu6DBt89gB6ENTeHBXCAi87NhDEE","D2L6yPZ2FmmmTKPgzaMKdhu6EWZcTpLy1Vhx8uvZe7NZ","9bnz4RShgq1hAnLnZbP8kbgBg1kEmcJBYQq3gQbmnSta","5VY91ws6B2hMmBFRsXkoAAdsPHBJwRfBht4DXox3xkwn","2nyhqdwKcJZR2vcqCyrYsaPVdAnFoJjiksCXJ7hfEYgD","2q5pghRs6arqVjRvT5gfgWfWcHWmw1ZuCzphgd5KfWGJ","wyvPkWjVZz1M8fHQnMMCDTQDbkManefNNhweYk5WkcF","3KCKozbAaF75qEU33jtzozcJ29yJuaLJTy2jFdzUY8bT","4vieeGHPYPG2MmyPRcYjdiDmmhN3ww7hsFNap8pVN3Ey","4TQLFNWK8AovT1gFvda5jfw2oJeRMKEmw7aH6MGBJ3or"].map(e=>new ge(e)),nt=2e3;async function Jr(e){let t=Buffer.from(e.serialize()).toString("base64"),r=await(await fetch(Zr,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({jsonrpc:"2.0",id:Date.now().toString(),method:"sendTransaction",params:[t,{encoding:"base64",skipPreflight:!0,maxRetries:0}]})})).json();if(console.log("Helius response:",JSON.stringify(r,null,2)),r.error)throw new Error(r.error.message);let i=r.result;return console.log("Transaction sent:",i),i}var rt=class{constructor(t){this.instructions=[];this.endInstructions=[];this.lookupTableAddress=[];this.signers=[];this.instructionTypes=[];this.endInstructionTypes=[];this.connection=t.connection,this.feePayer=t.feePayer,this.signAllTransactions=t.signAllTransactions,this.owner=t.owner,this.cluster=t.cluster,this.blockhashCommitment=t.blockhashCommitment,this.loopMultiTxStatus=!!t.loopMultiTxStatus}get AllTxData(){return{instructions:this.instructions,endInstructions:this.endInstructions,signers:this.signers,instructionTypes:this.instructionTypes,endInstructionTypes:this.endInstructionTypes,lookupTableAddress:this.lookupTableAddress}}get allInstructions(){return[...this.instructions,...this.endInstructions]}async getComputeBudgetConfig(){var r;let t=(await zr.get(`https://solanacompass.com/api/fees?cacheFreshTime=${3e5}`)).data,{avg:n}=(r=t==null?void 0:t[15])!=null?r:{};if(!!n)return{units:6e5,microLamports:Math.min(Math.ceil(n*1e6/6e5),25e3)}}addCustomComputeBudget(t){if(t){let{instructions:n,instructionTypes:r}=Ye(t);return this.instructions.unshift(...n),this.instructionTypes.unshift(...r),!0}return!1}addTipInstruction(t){var n;return t?(this.endInstructions.push(mn.transfer({fromPubkey:(n=t.feePayer)!=null?n:this.feePayer,toPubkey:new ge(t.address),lamports:BigInt(t.amount.toString())})),this.endInstructionTypes.push(Ne.TransferTip),!0):!1}async calComputeBudget({config:t,defaultIns:n}){try{let r=t||await this.getComputeBudgetConfig();if(this.addCustomComputeBudget(r))return;n&&this.instructions.unshift(...n)}catch{n&&this.instructions.unshift(...n)}}addInstruction({instructions:t=[],endInstructions:n=[],signers:r=[],instructionTypes:i=[],endInstructionTypes:o=[],lookupTableAddress:s=[]}){return this.instructions.push(...t),this.endInstructions.push(...n),this.signers.push(...r),this.instructionTypes.push(...i),this.endInstructionTypes.push(...o),this.lookupTableAddress.push(...s.filter(a=>a!==ge.default.toString())),this}async versionBuild({txVersion:t,extInfo:n}){return t===0?await this.buildV0(z({},n||{})):this.build(n)}build(t){var r;let n=new Me;return this.allInstructions.length&&n.add(...this.allInstructions),n.feePayer=this.feePayer,((r=this.owner)==null?void 0:r.signer)&&!this.signers.some(i=>i.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer),{builder:this,transaction:n,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async i=>{var l;let{recentBlockHash:o,skipPreflight:s=!0,sendAndConfirm:a,notSendToRpc:c}=i||{},u=o!=null?o:await Te(this.connection,this.blockhashCommitment);if(n.recentBlockhash=u,this.signers.length&&n.sign(...this.signers),pe([n]),console.log("SEND 1"),(l=this.owner)!=null&&l.isKeyPair)return{txId:a?await xt(this.connection,n,this.signers.find(m=>m.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:s}):await this.connection.sendRawTransaction(n.serialize(),{skipPreflight:s}),signedTx:n};if(this.signAllTransactions){let f=await this.signAllTransactions([n]);if(this.signers.length)for(let m of f)try{m.sign(...this.signers)}catch{}return{txId:c?"":await this.connection.sendRawTransaction(f[0].serialize(),{skipPreflight:s}),signedTx:f[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:t||{}}}buildMultiTx(t){var u;let{extraPreBuildData:n=[],extInfo:r}=t,{transaction:i}=this.build(r),o=n.filter(l=>l.transaction.instructions.length>0),s=[i,...o.map(l=>l.transaction)],a=[this.signers,...o.map(l=>l.signers)],c=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),{builder:this,transactions:s,signers:a,instructionTypes:c,execute:async l=>{var P;let{sequentially:f,onTxUpdate:m,skipTxCount:p=0,recentBlockHash:h,skipPreflight:g=!0}=l||{},b=h!=null?h:await Te(this.connection,this.blockhashCommitment);if((P=this.owner)!=null&&P.isKeyPair){if(f){let A=[],x=0;for(let y of s){if(++x,x<=p)continue;let T=await xt(this.connection,y,this.signers.find(S=>S.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:g});A.push(T)}return{txIds:A,signedTxs:s}}return{txIds:await await Promise.all(s.map(async A=>(A.recentBlockhash=b,await this.connection.sendRawTransaction(A.serialize(),{skipPreflight:g})))),signedTxs:s}}if(this.signAllTransactions){let A=s.map((y,T)=>(y.recentBlockhash=b,a[T].length&&y.sign(...a[T]),y));pe(A),console.log("SEND 2");let x=await this.signAllTransactions(A);if(f){let y=0,T=[],S=async()=>{if(!x[y])return;let N=await this.connection.sendRawTransaction(x[y].serialize(),{skipPreflight:g});T.push({txId:N,status:"sent",signedTx:x[y]}),m==null||m([...T]),y++;let w=!1,E=null,O=null,F=M=>{E!==null&&clearInterval(E),O!==null&&this.connection.removeSignatureListener(O);let v=T.findIndex(U=>U.txId===N);if(v>-1){if(T[v].status==="error"||T[v].status==="success")return;T[v].status=M.err?"error":"success"}m==null||m([...T]),M.err||S()};this.loopMultiTxStatus&&(E=setInterval(async()=>{var M;if(w){clearInterval(E);return}try{let v=await this.connection.getTransaction(N,{commitment:"confirmed",maxSupportedTransactionVersion:0});v&&(w=!0,clearInterval(E),F({err:((M=v.meta)==null?void 0:M.err)||null}),console.log("tx status from getTransaction:",N))}catch(v){w=!0,clearInterval(E),console.error("getTransaction timeout:",v,N)}},nt)),O=this.connection.onSignature(N,M=>{if(w){this.connection.removeSignatureListener(O);return}w=!0,F(M)},"confirmed"),this.connection.getSignatureStatus(N)};return await S(),{txIds:T.map(N=>N.txId),signedTxs:x}}else{let y=[];for(let T=0;T<x.length;T+=1){let S=await this.connection.sendRawTransaction(x[T].serialize(),{skipPreflight:g});y.push(S)}return{txIds:y,signedTxs:x}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async versionMultiBuild({extraPreBuildData:t,txVersion:n,extInfo:r}){return n===0?await this.buildV0MultiTx({extraPreBuildData:t,buildProps:r||{}}):this.buildMultiTx({extraPreBuildData:t,extInfo:r})}async buildV0(t){var g;let h=t||{},{lookupTableCache:n={},lookupTableAddress:r=[],forerunCreate:i,recentBlockhash:o}=h,s=Ve(h,["lookupTableCache","lookupTableAddress","forerunCreate","recentBlockhash"]),a=z(z({},this.cluster==="devnet"?{}:tt),n),c=Array.from(new Set([...r,...this.lookupTableAddress])),u=[];for(let b of c)a[b]===void 0&&u.push(new ge(b));let l=await Pt({connection:this.connection,address:u});for(let[b,P]of Object.entries(l))a[b]=P;let f=i?ge.default.toBase58():o!=null?o:await Te(this.connection,this.blockhashCommitment),m=new De({payerKey:this.feePayer,recentBlockhash:f,instructions:[...this.allInstructions]}).compileToV0Message(Object.values(a));((g=this.owner)==null?void 0:g.signer)&&!this.signers.some(b=>b.publicKey.equals(this.owner.publicKey))&&this.signers.push(this.owner.signer);let p=new Re(m);return p.sign(this.signers),{builder:this,transaction:p,signers:this.signers,instructionTypes:[...this.instructionTypes,...this.endInstructionTypes],execute:async b=>{var y;let{skipPreflight:P=!0,sendAndConfirm:A,notSendToRpc:x}=b||{};if(pe([p]),console.log("SEND 3"),(y=this.owner)!=null&&y.isKeyPair){let T=await this.connection.sendTransaction(p,{skipPreflight:P});return A&&await wt(this.connection,T),{txId:T,signedTx:p}}if(this.signAllTransactions){let T=await this.signAllTransactions([p]);if(this.signers.length)for(let S of T)try{S.sign(this.signers)}catch{}return{txId:x?"":await this.connection.sendTransaction(T[0],{skipPreflight:P}),signedTx:T[0]}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}async buildV0MultiTx(t){var u;let{extraPreBuildData:n=[],buildProps:r}=t,{transaction:i}=await this.buildV0(r),o=n.filter(l=>l.builder.instructions.length>0),s=[i,...o.map(l=>l.transaction)],a=[this.signers,...o.map(l=>l.signers)],c=[...this.instructionTypes,...o.map(l=>l.instructionTypes).flat()];return(u=this.owner)!=null&&u.signer&&a.forEach(l=>{l.some(f=>f.publicKey.equals(this.owner.publicKey))||this.signers.push(this.owner.signer)}),s.forEach(async(l,f)=>{l.sign(a[f])}),{builder:this,transactions:s,signers:a,instructionTypes:c,buildProps:r,execute:async l=>{var g;let{sequentially:f,onTxUpdate:m,recentBlockHash:p,skipPreflight:h=!0}=l||{};if(p&&s.forEach(b=>b.message.recentBlockhash=p),pe(s),console.log("SEND 4"),(g=this.owner)!=null&&g.isKeyPair){if(f){let b=[];for(let P of s){let A=await this.connection.sendTransaction(P,{skipPreflight:h});await wt(this.connection,A),b.push(A)}return{txIds:b,signedTxs:s}}return{txIds:await Promise.all(s.map(async b=>await this.connection.sendTransaction(b,{skipPreflight:h}))),signedTxs:s}}if(this.signAllTransactions){let b=await this.signAllTransactions(s);if(f){let P=0,A=[],x=async()=>{if(!b[P])return;let y=await this.connection.sendTransaction(b[P],{skipPreflight:h});A.push({txId:y,status:"sent",signedTx:b[P]}),m==null||m([...A]),P++;let T=!1,S=null,N=null,w=E=>{S!==null&&clearInterval(S),N!==null&&this.connection.removeSignatureListener(N);let O=A.findIndex(F=>F.txId===y);if(O>-1){if(A[O].status==="error"||A[O].status==="success")return;A[O].status=E.err?"error":"success"}m==null||m([...A]),E.err||x()};this.loopMultiTxStatus&&(S=setInterval(async()=>{var E;if(T){clearInterval(S);return}try{let O=await this.connection.getTransaction(y,{commitment:"confirmed",maxSupportedTransactionVersion:0});O&&(T=!0,clearInterval(S),w({err:((E=O.meta)==null?void 0:E.err)||null}),console.log("tx status from getTransaction:",y))}catch(O){T=!0,clearInterval(S),console.error("getTransaction timeout:",O,y)}},nt)),N=this.connection.onSignature(y,E=>{if(T){this.connection.removeSignatureListener(N);return}T=!0,w(E)},"confirmed"),this.connection.getSignatureStatus(y)};return x(),{txIds:[],signedTxs:b}}else{let P=[];for(let A=0;A<b.length;A+=1){let x=await this.connection.sendTransaction(b[A],{skipPreflight:h});P.push(x)}return{txIds:P,signedTxs:b}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:r||{}}}async sizeCheckBuild(t){var m;let f=t||{},{splitIns:n=[],computeBudgetConfig:r}=f,i=Ve(f,["splitIns","computeBudgetConfig"]),o=r?Ye(r):{instructions:[],instructionTypes:[]},s=this.signers.reduce((p,h)=>se(z({},p),{[h.publicKey.toBase58()]:h}),{}),a=[],c=[],u=[],l=0;if(this.allInstructions.forEach(p=>{let h=[...u,p],g=r?[...o.instructions,...h]:h,P=[...new Set(h.map(A=>A.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat()).values()].map(A=>new ge(A));if(p!==n[l]&&u.length<12&&(Ie({instructions:g,payer:this.feePayer,signers:P})||Ie({instructions:h,payer:this.feePayer,signers:P})))u.push(p);else{if(u.length===0)throw Error("item ins too big");l+=p===n[l]?1:0,Ie({instructions:r?[...o.instructions,...u]:[...u],payer:this.feePayer,signers:P})?a.push(new Me().add(...o.instructions,...u)):a.push(new Me().add(...u)),c.push(Array.from(new Set(u.map(A=>A.keys.filter(x=>x.isSigner).map(x=>x.pubkey.toString())).flat())).map(A=>s[A]).filter(A=>A!==void 0)),u=[p]}}),u.length>0){let h=[...new Set(u.map(g=>g.keys.filter(b=>b.isSigner).map(b=>b.pubkey.toString())).flat()).values()].map(g=>s[g]).filter(g=>g!==void 0);Ie({instructions:r?[...o.instructions,...u]:[...u],payer:this.feePayer,signers:h.map(g=>g.publicKey)})?a.push(new Me().add(...o.instructions,...u)):a.push(new Me().add(...u)),c.push(h)}return a.forEach(p=>p.feePayer=this.feePayer),(m=this.owner)!=null&&m.signer&&c.forEach(p=>{p.some(h=>h.publicKey.equals(this.owner.publicKey))||p.push(this.owner.signer)}),{builder:this,transactions:a,signers:c,instructionTypes:this.instructionTypes,execute:async p=>{var y;let{sequentially:h,onTxUpdate:g,skipTxCount:b=0,recentBlockHash:P,skipPreflight:A=!0}=p||{},x=P!=null?P:await Te(this.connection,this.blockhashCommitment);if(a.forEach(async(T,S)=>{T.recentBlockhash=x,c[S].length&&T.sign(...c[S])}),pe(a),console.log("SEND 5"),console.log("sizeCheckBuild"),(y=this.owner)!=null&&y.isKeyPair){if(h){let T=0,S=[];for(let N of a){if(++T,T<=b){S.push("tx skipped");continue}let w=await xt(this.connection,N,this.signers.find(E=>E.publicKey.equals(this.owner.publicKey))?this.signers:[...this.signers,this.owner.signer],{skipPreflight:A});S.push(w)}return{txIds:S,signedTxs:a}}return{txIds:await Promise.all(a.map(async T=>await this.connection.sendRawTransaction(T.serialize(),{skipPreflight:A}))),signedTxs:a}}if(this.signAllTransactions){let T=await this.signAllTransactions(a.slice(b,a.length)),S=[...a.slice(0,b),...T];if(h){let N=0,w=[],E=async()=>{if(!S[N])return;N<b&&(w.push({txId:"",status:"success",signedTx:S[N]}),g==null||g([...w]),N++,E());let O=await this.connection.sendRawTransaction(S[N].serialize(),{skipPreflight:A});w.push({txId:O,status:"sent",signedTx:S[N]}),g==null||g([...w]),N++;let F=!1,M=null,v=null,U=_=>{M!==null&&clearInterval(M),v!==null&&this.connection.removeSignatureListener(v);let I=w.findIndex(fe=>fe.txId===O);if(I>-1){if(w[I].status==="error"||w[I].status==="success")return;w[I].status=_.err?"error":"success"}g==null||g([...w]),_.err||E()};this.loopMultiTxStatus&&(M=setInterval(async()=>{var _;if(F){clearInterval(M);return}try{let I=await this.connection.getTransaction(O,{commitment:"confirmed",maxSupportedTransactionVersion:0});I&&(F=!0,clearInterval(M),U({err:((_=I.meta)==null?void 0:_.err)||null}),console.log("tx status from getTransaction:",O))}catch(I){F=!0,clearInterval(M),console.error("getTransaction timeout:",I,O)}},nt)),v=this.connection.onSignature(O,_=>{if(F){this.connection.removeSignatureListener(v);return}F=!0,U(_)},"confirmed"),this.connection.getSignatureStatus(O)};return await E(),{txIds:w.map(O=>O.txId),signedTxs:S}}else{let N=[];for(let w=0;w<S.length;w+=1){let E=await this.connection.sendRawTransaction(S[w].serialize(),{skipPreflight:A});N.push(E)}return{txIds:N,signedTxs:S}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:i||{}}}async sizeCheckBuildV0(t){var x;let A=t||{},{computeBudgetConfig:n,splitIns:r=[],lookupTableCache:i={},lookupTableAddress:o=[]}=A,s=Ve(A,["computeBudgetConfig","splitIns","lookupTableCache","lookupTableAddress"]),a=z(z({},this.cluster==="devnet"?{}:tt),i),c=Array.from(new Set([...this.lookupTableAddress,...o])),u=[];for(let y of c)a[y]===void 0&&u.push(new ge(y));let l=await Pt({connection:this.connection,address:u});for(let[y,T]of Object.entries(l))a[y]=T;let f=n?Ye(n):{instructions:[],instructionTypes:[]},m=await Te(this.connection,this.blockhashCommitment),p=this.signers.reduce((y,T)=>se(z({},y),{[T.publicKey.toBase58()]:T}),{}),h=[],g=[],b=[],P=0;if(this.allInstructions.forEach(y=>{let T=[...b,y],S=n?[...f.instructions,...T]:T;if(y!==r[P]&&b.length<12&&(Ee({instructions:S,payer:this.feePayer,lookupTableAddressAccount:a})||Ee({instructions:T,payer:this.feePayer,lookupTableAddressAccount:a})))b.push(y);else{if(b.length===0)throw Error("item ins too big");P+=y===r[P]?1:0;let N={};for(let w of[...new Set(c)])a[w]!==void 0&&(N[w]=a[w]);if(n&&Ee({instructions:[...f.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:m})){let w=new De({payerKey:this.feePayer,recentBlockhash:m,instructions:[...f.instructions,...b]}).compileToV0Message(Object.values(a));h.push(new Re(w))}else{let w=new De({payerKey:this.feePayer,recentBlockhash:m,instructions:[...b]}).compileToV0Message(Object.values(a));h.push(new Re(w))}g.push(Array.from(new Set(b.map(w=>w.keys.filter(E=>E.isSigner).map(E=>E.pubkey.toString())).flat())).map(w=>p[w]).filter(w=>w!==void 0)),b=[y]}}),b.length>0){let T=[...new Set(b.map(w=>w.keys.filter(E=>E.isSigner).map(E=>E.pubkey.toString())).flat()).values()].map(w=>p[w]).filter(w=>w!==void 0),S=dn[Math.floor(Math.random()*dn.length)],N=mn.transfer({fromPubkey:this.feePayer,toPubkey:S,lamports:Math.floor(.001*pn)});if(n&&Ee({instructions:[N,...f.instructions,...b],payer:this.feePayer,lookupTableAddressAccount:a,recentBlockhash:m})){let w=new De({payerKey:this.feePayer,recentBlockhash:m,instructions:[N,...f.instructions,...b]}).compileToV0Message(Object.values(a));h.push(new Re(w))}else{let w=new De({payerKey:this.feePayer,recentBlockhash:m,instructions:[N,...b]}).compileToV0Message(Object.values(a));h.push(new Re(w))}g.push(T)}return(x=this.owner)!=null&&x.signer&&g.forEach(y=>{y.some(T=>T.publicKey.equals(this.owner.publicKey))||y.push(this.owner.signer)}),h.forEach((y,T)=>{y.sign(g[T])}),{builder:this,transactions:h,buildProps:t,signers:g,instructionTypes:this.instructionTypes,execute:async y=>{var O;let{sequentially:T,onTxUpdate:S,skipTxCount:N=0,recentBlockHash:w,skipPreflight:E=!0}=y||{};if(h.map(async(F,M)=>{g[M].length&&F.sign(g[M]),w&&(F.message.recentBlockhash=w)}),pe(h),console.log("SEND 6"),console.log("sizeCheckBuildV0"),(O=this.owner)!=null&&O.isKeyPair){console.log("send transactions using Helius Sender");for(let F of h){let M=await Jr(F);console.log("Sent tx:",M)}return{txIds:[],signedTxs:[]}}if(this.signAllTransactions){let F=await this.signAllTransactions(h.slice(N,h.length)),M=[...h.slice(0,N),...F];if(T){let v=0,U=[],_=async()=>{if(!M[v])return;if(v<N){U.push({txId:"",status:"success",signedTx:M[v]}),S==null||S([...U]),v++,_();return}let I=await this.connection.sendTransaction(M[v],{skipPreflight:E});U.push({txId:I,status:"sent",signedTx:M[v]}),S==null||S([...U]),v++;let fe=!1,be=null,_e=null,Nt=me=>{be!==null&&clearInterval(be),_e!==null&&this.connection.removeSignatureListener(_e);let ne=U.findIndex(Pn=>Pn.txId===I);if(ne>-1){if(U[ne].status==="error"||U[ne].status==="success")return;U[ne].status=me.err?"error":"success"}S==null||S([...U]),me.err||_()};this.loopMultiTxStatus&&(be=setInterval(async()=>{var me;if(fe){clearInterval(be);return}try{let ne=await this.connection.getTransaction(I,{commitment:"confirmed",maxSupportedTransactionVersion:0});ne&&(fe=!0,clearInterval(be),Nt({err:((me=ne.meta)==null?void 0:me.err)||null}),console.log("tx status from getTransaction:",I))}catch(ne){fe=!0,clearInterval(be),console.error("getTransaction timeout:",ne,I)}},nt)),_e=this.connection.onSignature(I,me=>{if(fe){this.connection.removeSignatureListener(_e);return}fe=!0,Nt(me)},"confirmed"),this.connection.getSignatureStatus(I)};return _(),{txIds:[],signedTxs:M}}else{let v=[];for(let U=0;U<M.length;U+=1){let _=await this.connection.sendTransaction(M[U],{skipPreflight:E});v.push(_)}return{txIds:v,signedTxs:M}}}throw new Error("please provide owner in keypair format or signAllTransactions function")},extInfo:s||{}}}};import Qr from"bn.js";var Ja=new Qr(1e6);import{PublicKey as ni}from"@solana/web3.js";import yn,{isBN as wn}from"bn.js";import{bits as bu,BitStructure as yu,blob as Xr,Blob as wu,cstr as Tu,f32 as Pu,f32be as xu,f64 as Au,f64be as Su,greedy as Lu,Layout as Yr,ns64 as Cu,ns64be as ku,nu64 as Bu,nu64be as Nu,offset as Iu,s16 as Eu,s16be as Mu,s24 as Du,s24be as Ru,s32 as Ou,s32be as vu,s40 as _u,s40be as Fu,s48 as Vu,s48be as Ku,s8 as Wu,seq as $r,struct as Uu,Structure as ei,u16 as qu,u16be as Gu,u24 as Hu,u24be as ju,u32 as zu,u32be as Zu,u40 as Ju,u40be as Qu,u48 as Xu,u48be as Yu,u8 as $u,UInt as ti,union as ec,Union as tc,unionLayoutDiscriminator as nc,utf8 as rc}from"@solana/buffer-layout";var At=Yr,gn=ei;var hn=ti;var bn=$r;var Pe=Xr;var St=class extends At{constructor(n,r,i){super(n,i);this.blob=Pe(n),this.signed=r}decode(n,r=0){let i=new yn(this.blob.decode(n,r),10,"le");return this.signed?i.fromTwos(this.span*8).clone():i}encode(n,r,i=0){return typeof n=="number"&&(n=new yn(n)),this.signed&&(n=n.toTwos(this.span*8)),this.blob.encode(n.toArrayLike(Buffer,"le",this.span),r,i)}};function xe(e){return new hn(1,e)}function ee(e){return new St(8,!1,e)}var Lt=class extends At{constructor(n,r,i,o){super(n.span,o);this.layout=n,this.decoder=r,this.encoder=i}decode(n,r){return this.decoder(this.layout.decode(n,r))}encode(n,r,i){return this.layout.encode(this.encoder(n),r,i)}getSpan(n,r){return this.layout.getSpan(n,r)}};function he(e){return new Lt(Pe(32),t=>new ni(t),t=>t.toBuffer(),e)}var Ct=class extends gn{decode(t,n){return super.decode(t,n)}};function Ae(e,t,n){return new Ct(e,t,n)}function Oe(e,t,n){let r,i=typeof t=="number"?t:wn(t)?t.toNumber():new Proxy(t,{get(o,s){if(!r){let a=Reflect.get(o,"count");r=wn(a)?a.toNumber():a,Reflect.set(o,"count",r)}return Reflect.get(o,s)},set(o,s,a){return s==="count"&&(r=a),Reflect.set(o,s,a)}});return bn(e,i,n)}var kt=(...e)=>e.map(t=>{try{return typeof t=="object"?JSON.stringify(t):t}catch{return t}}).join(", "),ve=class{constructor({scope:t,moduleName:n}){this.disabled=!1;this.scope=t,this.logger=Z(n)}createTxBuilder(t){return this.scope.checkOwner(),new rt({connection:this.scope.connection,feePayer:t||this.scope.ownerPubKey,cluster:this.scope.cluster,owner:this.scope.owner,blockhashCommitment:this.scope.blockhashCommitment,loopMultiTxStatus:this.scope.loopMultiTxStatus,api:this.scope.api,signAllTransactions:this.scope.signAllTransactions})}logDebug(...t){this.logger.debug(kt(t))}logInfo(...t){this.logger.info(kt(t))}logAndCreateError(...t){let n=kt(t);throw new Error(n)}checkDisabled(){(this.disabled||!this.scope)&&this.logAndCreateError("module not working")}};var j=class extends ve{static getPdaPoolId(t,n){return $e([j.SEED_CONFIG.pool.id,n.toBuffer()],t)}static getPdaOwnerId(t,n,r,i){return $e([j.SEED_CONFIG.owner.id,n.toBuffer(),r.toBuffer(),Buffer.from(new Tn(i).toArray())],t)}static async getAllInfo({connection:t,programId:n,poolIds:r,wallet:i,chainTime:o}){if(r.length===0)return[];let s=r.map(l=>j.getPdaPoolId(n,l).publicKey),a=[];for(let l=0;l<j.VERSION_PROJECT.length;l++)a.push(...s.map(f=>j.getPdaOwnerId(n,f,i,l).publicKey));let c=await Ke(t,[...s,...a]),u=[];for(let l=0;l<c.length;l++){let f=Math.floor(l/r.length),m=l%r.length,p=s[m],h=a[l],g=c[m],b=c[r.length+l];if(!(g&&b)||g.data.length!==j.POOL_LAYOUT.span||b.data.length!==j.OWNER_LAYOUT.span)continue;let P=j.POOL_LAYOUT.decode(g.data),A=j.OWNER_LAYOUT.decode(b.data),x=P.openTime.toNumber(),y=P.endTime.toNumber(),T=A.tokenInfo.map(w=>w.debtAmount.gt(new Tn(0))).filter(w=>!w).length!==3,S=o>x&&o<y&&P.status===1,N=T&&S;u.push({programId:n,poolId:p,ammId:P.ammId,ownerAccountId:h,snapshotLpAmount:A.lpAmount,project:j.VERSION_PROJECT[f],openTime:x,endTime:y,canClaim:N,canClaimErrorType:T?S?void 0:"outOfOperationalTime":"alreadyClaimIt",tokenInfo:P.tokenInfo.map((w,E)=>({mintAddress:w.mintAddress,mintVault:w.mintVault,mintDecimals:w.mintDecimals,perLpLoss:w.perLpLoss,debtAmount:A.tokenInfo[E].debtAmount.add(A.tokenInfo[E].claimedAmount)}))})}return u}async makeClaimTransaction({poolInfo:t,ownerInfo:n,feePayer:r}){n.wallet||this.scope.checkOwner();let i=this.createTxBuilder(r),o=n.wallet||this.scope.ownerPubKey,s=[];for(let u of t.tokenInfo){let{account:l,instructionParams:f}=await this.scope.account.getOrCreateTokenAccount({mint:u.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:u.mintAddress.equals(Q.WSOL.mint),createInfo:{payer:o,amount:0},skipCloseAccount:!u.mintAddress.equals(Q.WSOL.mint),associatedOnly:u.mintAddress.equals(Q.WSOL.mint)?!1:n.associatedOnly});f&&i.addInstruction(f),s.push(l)}i.addInstruction({instructions:[j.makeClaimInstruction({programId:t.programId,poolInfo:t,ownerInfo:{wallet:o,ownerPda:t.ownerAccountId,claimAddress:s}})]});let{transaction:a,signers:c}=i.build();return[{transaction:a,signer:c}]}async makeClaimAllTransaction({poolInfos:t,ownerInfo:n,feePayer:r}){let i=this.createTxBuilder(r),o=n.wallet||this.scope.ownerPubKey,s={};for(let l of t){let f=[];for(let m of l.tokenInfo){let{account:p,instructionParams:h}=await this.scope.account.getOrCreateTokenAccount({mint:m.mintAddress,owner:this.scope.ownerPubKey,notUseTokenAccount:m.mintAddress.equals(Q.WSOL.mint),createInfo:{payer:o,amount:0},skipCloseAccount:!m.mintAddress.equals(Q.WSOL.mint),associatedOnly:m.mintAddress.equals(Q.WSOL.mint)?!1:n.associatedOnly});h&&i.addInstruction(h),p&&(s[m.mintAddress.toString()]=p,f.push(p))}i.addInstruction({instructions:[j.makeClaimInstruction({programId:l.programId,poolInfo:l,ownerInfo:{wallet:o,ownerPda:l.ownerAccountId,claimAddress:f}})]})}let{transaction:a,signers:c}=i.build(),u=i.allInstructions;return Tt(u,[o,...c.map(l=>l.publicKey)])?[{transaction:a,signer:c}]:[{transaction:new Bt().add(...u.slice(0,i.AllTxData.instructions.length-1)),signer:c},{transaction:new Bt().add(...u.slice(i.AllTxData.instructions.length-1)),signer:[]},{transaction:new Bt().add(...i.AllTxData.endInstructions),signer:[]}]}static makeClaimInstruction({programId:t,poolInfo:n,ownerInfo:r}){let i=Ae([]),o=[{pubkey:r.wallet,isSigner:!0,isWritable:!0},{pubkey:n.poolId,isSigner:!1,isWritable:!0},{pubkey:r.ownerPda,isSigner:!1,isWritable:!0},...r.claimAddress.map(c=>({pubkey:c,isSigner:!1,isWritable:!0})),...n.tokenInfo.map(({mintVault:c})=>({pubkey:c,isSigner:!1,isWritable:!0})),{pubkey:oi,isSigner:!1,isWritable:!1}],s=Buffer.alloc(i.span);i.encode({},s);let a=Buffer.from([10,66,208,184,161,6,191,98,...s]);return new ii({keys:o,programId:t,data:a})}},te=j;te.CLAIMED_NUM=3,te.POOL_LAYOUT=Ae([Pe(8),xe("bump"),xe("status"),ee("openTime"),ee("endTime"),he("ammId"),Oe(Ae([xe("mintDecimals"),he("mintAddress"),he("mintVault"),ee("perLpLoss"),ee("totalClaimedAmount")]),j.CLAIMED_NUM,"tokenInfo"),Oe(ee(),10,"padding")]),te.OWNER_LAYOUT=Ae([Pe(8),xe("bump"),xe("version"),he("poolId"),he("owner"),ee("lpAmount"),Oe(Ae([he("mintAddress"),ee("debtAmount"),ee("claimedAmount")]),j.CLAIMED_NUM,"tokenInfo"),Oe(ee(),4,"padding")]),te.DEFAULT_POOL_ID=["58oQChx4yWmvKdwLLZzBi4ChoCc2fqCUWBkwMihLYQo2","6UmmUiYoBjSrhakAobJw8BvkmJtDVxaeBtbt7rxWo1mg","AVs9TA4nWDzfPJE9gGVNJMVhcQy3V9PGazuz33BfG2RA","DVa7Qmb5ct9RCpaU7UTpSaf3GVMYz17vNVU67XpdCRut","7XawhbbxtsRcQA8KTkHT9f9nc6d69UwqCDh6U5EEbEmX","6a1CsrpeZubDjEJE9s1CMVheB6HWM5d7m1cj2jkhyXhj","EoNrn8iUhwgJySD1pHu8Qxm5gSQqLK3za4m8xzD2RuEb","AceAyRTWt4PyB2pHqf2qhDgNZDtKVNaxgL8Ru3V4aN1P","6tmFJbMk5yVHFcFy7X2K8RwHjKLr6KVFLYXpgpBNeAxB"].map(t=>new ri(t)),te.SEED_CONFIG={pool:{id:Buffer.from("pool_seed","utf8")},owner:{id:Buffer.from("user_claim_seed","utf8")}},te.VERSION_PROJECT=[void 0,"Francium","Tulip","Larix"];export{te as default};
//# sourceMappingURL=index.mjs.map